{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/home/momen/projects/spotmycrib-master/imports/ui/templates/lettingprintview.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","objectRestSpread","objectRestSpread","asyncGenerators","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"os.linux.x86_64"},"sourceFileName":"imports/ui/templates/lettingprintview.js","filename":"/home/momen/projects/spotmycrib-master/imports/ui/templates/lettingprintview.js","targets":{},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/home/momen/projects/spotmycrib-master","root":"/home/momen/projects/spotmycrib-master","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.13.10","helpers":true,"useESModules":false,"corejs":false}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-meteor-async-await","visitor":{"AwaitExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]},"ClassPrivateMethod":{"exit":[null]}},"options":{"useNativeAsyncAwait":false}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":{},"_verified":{},"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}}],"presets":[],"generatorOpts":{"filename":"/home/momen/projects/spotmycrib-master/imports/ui/templates/lettingprintview.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"imports/ui/templates/lettingprintview.js"}},"code":"module.link(\"./lettingprintview.html\");\nTemplate.lettingprintview.onCreated(function () {\n  var instance = this;\n  instance.isSubsLoaded = new ReactiveVar(false);\n  instance.autorun(function () {\n    var key = FlowRouter.getParam('key');\n    instance.subscribe(\"viewLetting\", key);\n    instance.subscribe('Config'); // instance.subscribe('Properties');\n    // instance.subscribe('Auctions');\n\n    if (instance.subscriptionsReady()) {\n      instance.isSubsLoaded.set(true);\n    }\n  });\n});\nTemplate.lettingprintview.helpers({\n  isSubsLoaded: function () {\n    return Template.instance().subscriptionsReady();\n  },\n  userLoggedIn: function () {\n    if (Meteor.user()) return true;\n    return false;\n  },\n  data: function () {\n    // debugger;\n    var id = FlowRouter.getParam('key');\n    let Projects = Collections.Auctions;\n    let selector = {\n      \"lettingAuctionCode\": id\n    };\n    var ret = Projects.find(selector, {\n      transform: function (data) {\n        var globalConfig = Collections.Config.findOne();\n        data.PD = Collections.Properties.findOne(data.propertyId);\n        data.PD.bedroomsCount = 0;\n        data.PD.ensuiteCount = 0;\n        data.PD.doubleBedCount = 0;\n\n        if (data.PD.bedrooms) {\n          data.PD.bedroomsCount = data.PD.bedrooms.length;\n\n          for (var i = 0; i < data.PD.bedrooms.length; i++) {\n            if (data.PD.bedrooms[i][\"ensuite\"]) {\n              data.PD.ensuiteCount++;\n            }\n\n            if (data.PD.bedrooms[i][\"bedType\"] == 'double') {\n              data.PD.doubleBedCount++;\n            }\n          }\n        }\n\n        if (data.PD.contacts) {\n          data.primaryContact = data.PD.contacts[0];\n        } else data.primaryContact = {};\n\n        tmp = [];\n\n        if (data.PD.amenities) {\n          for (var i = 0; i < data.PD.amenities.length; i++) {\n            var src = globalConfig.amenitiesLogos[data.PD.amenities[i]];\n            if (!src) src = globalConfig.amenitiesLogos[\"default\"];\n            tmp.push({\n              name: data.PD.amenities[i],\n              src: src\n            });\n          }\n        }\n\n        data.PD.amenitiesWithImgs = tmp;\n        return data;\n      },\n      limit: 1\n    }).fetch();\n    ret = ret[0];\n    clearMeta();\n\n    try {\n      var title = 'Print key for ' + ret.PD.address.address + ', ' + ret.PD.address.area;\n      if (ret.PD.address.county) title += ', ' + ret.PD.address.county;\n      DocHead.setTitle('' + titleCase(title) + ' | SpotMyCrib');\n      DocHead.addMeta({\n        name: \"description\",\n        content: \"Print key for \" + ret.PD.type + \".\"\n      });\n    } catch (err) {\n      DocHead.setTitle(' Property not found | SpotMyCrib Admin');\n      DocHead.addMeta({\n        name: \"description\",\n        content: \"\"\n      });\n    }\n\n    return ret;\n  }\n});\nTemplate.lettingprintview.onRendered(function () {\n  // console.log(this)\n  setTimeout(function () {\n    window.print();\n  }, 1000);\n});","map":{"version":3,"sources":["imports/ui/templates/lettingprintview.js"],"names":["module","link","Template","lettingprintview","onCreated","instance","isSubsLoaded","ReactiveVar","autorun","key","FlowRouter","getParam","subscribe","subscriptionsReady","set","helpers","userLoggedIn","Meteor","user","data","id","Projects","Collections","Auctions","selector","ret","find","transform","globalConfig","Config","findOne","PD","Properties","propertyId","bedroomsCount","ensuiteCount","doubleBedCount","bedrooms","length","i","contacts","primaryContact","tmp","amenities","src","amenitiesLogos","push","name","amenitiesWithImgs","limit","fetch","clearMeta","title","address","area","county","DocHead","setTitle","titleCase","addMeta","content","type","err","onRendered","setTimeout","window","print"],"mappings":"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","sourcesContent":["/**\n * Created by njanjanam on 19/05/2017.\n */\nimport './lettingprintview.html';\n\nTemplate.lettingprintview.onCreated(function() {\n    var instance = this;\n    instance.isSubsLoaded = new ReactiveVar(false);\n    instance.autorun(function(){\n\n        var key = FlowRouter.getParam('key');\n        instance.subscribe(\"viewLetting\",key) ;\n        instance.subscribe('Config');\n\n        // instance.subscribe('Properties');\n        // instance.subscribe('Auctions');\n\n        if(instance.subscriptionsReady()){\n            instance.isSubsLoaded.set(true)\n        }\n    })\n})\nTemplate.lettingprintview.helpers({\n    isSubsLoaded: function () {\n        return Template.instance().subscriptionsReady();\n    },\n    userLoggedIn: function () {\n        if (Meteor.user())return true;\n        return false;\n    },\n    data : function () {\n        // debugger;\n        var id = FlowRouter.getParam('key');\n        let Projects = Collections.Auctions;\n        let selector = {\n            \"lettingAuctionCode\" : id\n        };\n        var ret = Projects.find(selector, {\n            transform: function(data){\n\n                var globalConfig = Collections.Config.findOne();\n                data.PD = Collections.Properties.findOne(data.propertyId);\n\n                data.PD.bedroomsCount=0\n                data.PD.ensuiteCount = 0;\n                data.PD.doubleBedCount = 0;\n                if(data.PD.bedrooms){\n                    data.PD.bedroomsCount = data.PD.bedrooms.length;\n                    for (var i = 0; i < data.PD.bedrooms.length; i++) {\n                        if (data.PD.bedrooms[i][\"ensuite\"] ) {\n                            data.PD.ensuiteCount++;\n                        }\n                        if (data.PD.bedrooms[i][\"bedType\"] == 'double' ) {\n                            data.PD.doubleBedCount++;\n                        }\n                    }\n                }\n\n\n                if(data.PD.contacts) {\n                    data.primaryContact = data.PD.contacts[0];\n                }else data.primaryContact = {};\n\n                tmp = [];\n                if(data.PD.amenities){\n                    for ( var i=0; i< data.PD.amenities.length;i++){\n                        var src = globalConfig.amenitiesLogos[data.PD.amenities[i]];\n                        if(!src)src = globalConfig.amenitiesLogos[\"default\"]\n                        tmp.push({name:data.PD.amenities[i], src: src })\n                    }\n                }\n                data.PD.amenitiesWithImgs = tmp;\n\n\n                return data;\n            },\n            limit: 1\n        }).fetch();\n        ret = ret[0];\n\n        clearMeta();\n        try {\n            var title = 'Print key for ' + ret.PD.address.address + ', ' + ret.PD.address.area;\n            if (ret.PD.address.county) title += ', ' + ret.PD.address.county;\n\n            DocHead.setTitle('' + titleCase(title) + ' | SpotMyCrib');\n            DocHead.addMeta({name: \"description\", content: \"Print key for \" + ret.PD.type + \".\"});\n        }catch(err){\n            DocHead.setTitle(' Property not found | SpotMyCrib Admin');\n            DocHead.addMeta({name: \"description\", content: \"\"});\n        }\n\n        return ret;\n    }\n});\nTemplate.lettingprintview.onRendered(function() {\n    // console.log(this)\n\n    setTimeout(function () {\n        window.print();\n    },1000)\n})"]},"sourceType":"module","hash":"c82f4c3cef41b975d935c0ebc1c29bae0fbb5bb9"}
