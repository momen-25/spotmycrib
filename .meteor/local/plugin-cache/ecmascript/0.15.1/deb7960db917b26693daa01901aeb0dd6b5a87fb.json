{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/home/momen/projects/spotmycrib-master/imports/ui/templates/editProperty.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"imports/ui/templates/editProperty.js","filename":"/home/momen/projects/spotmycrib-master/imports/ui/templates/editProperty.js","targets":{},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/home/momen/projects/spotmycrib-master","root":"/home/momen/projects/spotmycrib-master","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.13.10","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":{},"_verified":{},"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}}],"presets":[],"generatorOpts":{"filename":"/home/momen/projects/spotmycrib-master/imports/ui/templates/editProperty.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"imports/ui/templates/editProperty.js"}},"code":"module.link(\"./imageView.html\");\nmodule.link(\"./editProperty.html\");\nmodule.link(\"./shared.js\");\nlet filestack;\nmodule.link(\"filestack-js\", {\n  default(v) {\n    filestack = v;\n  }\n\n}, 0);\nconst apikey = 'AIPACLEs7ShGwwPh6fMTxz';\nconst fsClient = filestack.init(apikey, {\n  policy: 'eyJleHBpcnkiOjE4NjE5MjAwMDAsImNhbGwiOlsicGljayIsInJlYWQiLCJzdGF0Iiwid3JpdGUiLCJ3cml0ZVVybCIsInN0b3JlIiwiY29udmVydCIsInJlbW92ZSIsImV4aWYiXX0=',\n  signature: '465e8652c5cef95f44e5858e09d430abea855d98deaeb7425558f2c80d0f4f57'\n}); // import SimpleSchema from \"simpl-schema\";\n// SimpleSchema.extendOptions(['autoform']);\n\nTemplate.editProperty.onCreated(function () {\n  // this.showEditProperty = new ReactiveVar( false );\n  // console.log(this.data.propertyData)\n  // debugger;\n  var instance = this;\n  instance.isSubsLoaded = new ReactiveVar(false);\n  instance.autorun(function () {\n    instance.subscribe('Config');\n    var id = FlowRouter.getParam('id');\n    instance.subscribe('editProperty', id);\n    instance.subscribe('Areas'); //Let it wait in edit prop page\n\n    instance.subscribe('userData');\n\n    if (instance.subscriptionsReady()) {\n      instance.isSubsLoaded.set(true);\n    }\n  });\n  this.deactivateInProgress = new ReactiveVar(false);\n  this.archiveInProgress = new ReactiveVar(false); // Session.set('editPropertyImagesNewOnes',[]);\n  // var gallery = this.data.propertyData.gallery;\n  // if(!gallery)gallery=[]\n  // Session.set('editPropertyImages',gallery);\n});\nTemplate.editProperty.helpers({\n  // showEditProperty: function () {\n  //     return Template.instance().showEditProperty.get();\n  // },\n  // propertyData : function () {\n  //     var ret = getpropertyData();\n  //     // console.log(\"propertyData\");\n  //     // console.log(ret);\n  //     Session.set('propertyData',ret);\n  //     return ret;\n  // },\n  isSubsLoaded: function () {\n    return Template.instance().subscriptionsReady();\n  },\n  userLoggedIn: function () {\n    if (Meteor.user()) return true;\n    return false;\n  },\n  propertyData: function () {\n    // debugger;\n    var id = FlowRouter.current().params.id;\n    var ret = Collections.Properties.find(id, {\n      transform: function (data) {\n        var globalConfig = Collections.Config.findOne();\n        if (data.auctionId) data.auction = Collections.Auctions.findOne(data.auctionId);\n        return data;\n      },\n      limit: 1\n    }).fetch();\n    ret = ret[0];\n    clearMeta();\n\n    try {\n      var title = 'Editing ' + ret.address.address + ', ' + ret.address.area;\n      if (ret.address.county) title += ', ' + ret.address.county;\n      DocHead.setTitle('' + titleCase(title) + ' | SpotMyCrib Admin');\n      DocHead.addMeta({\n        name: \"description\",\n        content: \"Edit property \" + ret.type + \", upload its images, details and much more.\"\n      });\n    } catch (err) {\n      DocHead.setTitle(' Property not found | SpotMyCrib Admin');\n      DocHead.addMeta({\n        name: \"description\",\n        content: \"\"\n      });\n    }\n\n    Session.set(\"propertyData\", ret);\n    return ret; // return {propertyData: ret};\n  },\n  propertyFound: function () {\n    var c = Collections.Properties.find().count();\n    if (c) return true;\n    return false;\n  },\n  inIgnoreList: function (str) {\n    ignoreList = ['gallery', 'isArchived'];\n    if (ignoreList.indexOf(str) !== -1) return true;\n    return false;\n  },\n  deactivateInProgress: function () {\n    deactivateInProgress = Template.instance().deactivateInProgress;\n    return Template.instance().deactivateInProgress.get();\n  },\n  archiveInProgress: function () {\n    archiveInProgress = Template.instance().archiveInProgress;\n    return Template.instance().archiveInProgress.get();\n  } // getGallery:function () {\n  //     // debugger;\n  //     var propertyData = Session.get('propertyData');\n  //     return propertyData.gallery;\n  // }\n\n});\nTemplate.editProperty.onRendered(function () {\n  try {\n    jQuery(\"html,body\").animate({\n      scrollTop: 0\n    }, 250);\n  } catch (e) {\n    document.body.scrollTop = document.documentElement.scrollTop = 0;\n  }\n});\nTemplate.editProperty.events({\n  \"click .deactivatePropertyBtn\": function (event, template) {\n    event.preventDefault();\n    var propertyData = Session.get('propertyData');\n\n    if (!propertyData) {\n      console.log(\"Empty project data\");\n      return false;\n    }\n\n    var user = Meteor.user();\n\n    if (!user) {\n      console.log(\"Invalid user\");\n      return;\n    }\n\n    if (propertyData.createdByAgent != user._id) {\n      console.log(\"Invalid user\");\n      return;\n    }\n\n    $.fancybox({\n      'padding': 0,\n      'href': '#conf-dactivate-pop',\n      afterShow: function (template) {\n        attachEvents();\n      },\n      afterClose: function (template) {\n        console.log(template);\n      }\n    });\n  },\n  \"click .archivePropertyBtn\": function (event, template) {\n    event.preventDefault();\n    var propertyData = Session.get('propertyData');\n\n    if (!propertyData) {\n      console.log(\"Empty project data\");\n      return false;\n    }\n\n    var user = Meteor.user();\n\n    if (!user) {\n      console.log(\"Invalid user\");\n      return;\n    }\n\n    if (propertyData.createdByAgent != user._id) {\n      console.log(\"Invalid user\");\n      return;\n    }\n\n    $.fancybox({\n      'padding': 0,\n      'href': '#conf-archive-pop',\n      afterShow: function (template) {\n        attachEvents();\n      },\n      afterClose: function (template) {\n        console.log(template);\n      }\n    });\n  },\n  // 'change .selectPropertyImages': function(event, template) {\n  //     var files = event.target.files;\n  //     S3.upload({\n  //         files:files,\n  //         path:\"propertyImagesLarge\"\n  //     },function(e,r){\n  //         if(e){\n  //             throw new Meteor.Error('Upload failed ', e);\n  //             var tmp =  Session.get(\"showErrorDlg\");if(!tmp)tmp=[];\n  //             tmp.push(\"Upload failed: please check your internet connection, contact us if needed.\");\n  //             Session.set(\"showErrorDlg\",tmp)\n  //             return;\n  //         }\n  //         var editPropertyImages = Session.get('editPropertyImages');\n  //         var editPropertyImagesNewOnes = Session.get('editPropertyImagesNewOnes');\n  //         var tmp = {\n  //             name: r.file.original_name,\n  //             relative_url: r.relative_url,\n  //             url: r.secure_url\n  //         };\n  //         editPropertyImages.push(tmp);\n  //         editPropertyImagesNewOnes.push(tmp);\n  //         Session.set('editPropertyImages',editPropertyImages);\n  //         Session.set('editPropertyImagesNewOnes',editPropertyImagesNewOnes);\n  //         var propertyData = Session.get(\"propertyData\");\n  //         updateGalleriesInServer(editPropertyImages,propertyData._id, function (err, res) {\n  //             if (err) {\n  //                 console.log(err);\n  //                 var tmp =  Session.get(\"showErrorDlg\");if(!tmp)tmp=[];\n  //                 tmp.push(\"Upload failed: please check your internet connection, contact us if needed.\");\n  //                 Session.set(\"showErrorDlg\",tmp)\n  //                 return;\n  //             } else {\n  //                 var editPropertyImages = Session.get('editPropertyImages');\n  //                 console.log(\"Current Count: \"+editPropertyImages.length )\n  //             }\n  //         });\n  //         console.log(r);\n  //     });\n  // },\n  \"click .backBtn\": function (event, template) {\n    goBack();\n  },\n  'change input[name=price]': function (event, template) {\n    if (event.target.value) {\n      var tmp = event.target.value.split('.');\n      tmp = tmp[0]; //No decimals\n\n      tmp = tmp.trim().match(/\\d+/g);\n      if (!Array.isArray(tmp)) event.target.value = '';\n      event.target.value = tmp.join('');\n    }\n  },\n  \"click .showCopyDlg\": function (event, template) {\n    var propertyData = Session.get('propertyData');\n    let user = Meteor.user();\n    let sluggedName = slugifyEmailAddress(user.profile.name);\n    if (!sluggedName) sluggedName = 'rent';\n    let email = sluggedName + '-let-' + propertyData.auction.lettingAuctionCode.toLowerCase() + \"@spotmycrib.ie\";\n    $('#agentPropertyEmailField').val(email);\n    var url = FlowRouter.url('letting', {\n      key: propertyData.auction.lettingAuctionCode\n    });\n    $('#propertyLinkField').val(url);\n    $.fancybox({\n      'padding': 0,\n      'href': '#propertyLinkDlg',\n      afterShow: function (template) {\n        $('#agentPropertyEmailField').select();\n        $('#propertyLinkDlg .copyEmailBtn').unbind().bind('click', function () {\n          $('#agentPropertyEmailField').select();\n\n          try {\n            var successful = document.execCommand('copy');\n            var msg = successful ? 'successful' : 'unsuccessful'; // console.log('Copying text command was ' + msg);\n\n            $.fancybox.close();\n          } catch (err) {\n            console.log('Oops, unable to copy');\n          }\n\n          ga('send', 'event', 'editPropertyPage', 'copyShareEmail', 'copyShareEmail Btn Clicked');\n        });\n        $('#propertyLinkDlg .copyLinkBtn').unbind().bind('click', function () {\n          $('#propertyLinkField').select();\n\n          try {\n            var successful = document.execCommand('copy');\n            var msg = successful ? 'successful' : 'unsuccessful'; // console.log('Copying text command was ' + msg);\n\n            $.fancybox.close();\n          } catch (err) {\n            console.log('Oops, unable to copy');\n          }\n\n          ga('send', 'event', 'editPropertyPage', 'copyShareLink', 'copyShareLink Btn Clicked');\n        });\n        $('#propertyLinkDlg .cancelBtn').unbind().bind('click', function () {\n          $.fancybox.close();\n        });\n      }\n    });\n  }\n});\nTemplate.editPropertyForm.onCreated(function () {\n  if (!Session.get('editPropertyImages')) {\n    // Lets do this. Anyways we have delete button.\n    Session.set('editPropertyImages', []);\n    S3.collection.remove({});\n  }\n\n  this.numBedRoomCount = new ReactiveVar(0);\n  this.editPropertyFormSaving = new ReactiveVar(false);\n  this.countySelected = new ReactiveVar(false);\n  var instance = this;\n  instance.isSubsLoaded = new ReactiveVar(false);\n  instance.autorun(function () {\n    if (instance.countySelected.get()) {\n      instance.isSubsLoaded.set(false);\n      instance.subscribe('Areas', '', '', instance.countySelected.get(), '', '');\n    }\n\n    if (instance.subscriptionsReady()) {\n      instance.isSubsLoaded.set(true);\n    }\n  });\n  Session.set('editPropertyImagesNewOnes', []);\n  var gallery = [];\n\n  try {\n    gallery = this.data.propertyData.gallery;\n  } catch (e) {\n    gallery = [];\n  }\n\n  Session.set('editPropertyImages', gallery);\n});\nTemplate.editPropertyForm.helpers({\n  'data': function () {\n    var user = Meteor.user();\n    if (!user) return {\n      results: []\n    };\n    var id = FlowRouter.current().params.id;\n    var doc = Collections.Properties.findOne(id, {\n      transform: function (data) {\n        if (data.auctionId) data.auction = Collections.Auctions.findOne(data.auctionId);\n        return data;\n      },\n      limit: 1\n    });\n    if (doc) if (doc.bedrooms) Template.instance().numBedRoomCount.set(doc.bedrooms.length);\n    if (doc) if (doc.gallery) Session.set('editPropertyImages', doc.gallery); //This will re-run everytime u update an images and data gets fetched again.\n\n    return doc;\n  },\n  trimVal: function (str) {\n    return str.trim();\n  },\n  isEqualSelect: function (a, b) {\n    if (a == b) return 'selected';\n    return '';\n  },\n  isEqualCheck: function (a, b) {\n    if (a == b) return 'checked';\n    return '';\n  },\n  furnishedOptions: function (isFurnished) {\n    return [{\n      label: \"yes\",\n      value: \"true\",\n      selected: isFurnished ? 'selected' : ''\n    }, {\n      label: \"No\",\n      value: \"false\",\n      selected: !isFurnished ? 'selected' : ''\n    }];\n  },\n  countries: function () {\n    return [{\n      label: \"Ireland\",\n      value: \"Ireland\",\n      selected: \"selected\"\n    }]; //Both capital\n  },\n  counties: function () {\n    let staticCounties = [\"Carlow\", \"Cavan\", \"Clare\", \"Cork\", \"Donegal\", \"Dublin\", \"Galway\", \"Kerry\", \"Kildare\", \"Kilkenny\", \"Laois\", \"Leitrim\", \"Limerick\", \"Longford\", \"Louth\", \"Mayo\", \"Meath\", \"Monaghan\", \"Offaly\", \"Roscommon\", \"Sligo\", \"Tipperary\", \"Waterford\", \"Westmeath\", \"Wexford\", \"Wicklow\"];\n    let ret = [];\n\n    for (let i = 0; i < staticCounties.length; i++) {\n      if (!staticCounties[i]) continue;\n      ret.push({\n        label: titleCase(staticCounties[i]),\n        value: staticCounties[i]\n      });\n    }\n\n    return ret; // return [{label: \"Dublin\", value: \"dublin\"}];//Both capital\n    // var distinctEntries = _.uniq(Collections.Areas.find({}, {\n    //     sort: {County: 1}, fields: {County: true}\n    // }).fetch().map(function(x) {\n    //     return x.County;\n    // }), true);\n    // var ret = []\n    // for(var i=0;i< distinctEntries.length;i++){\n    //     if(!distinctEntries[i])continue;\n    //     ret.push({label: titleCase(distinctEntries[i]), value: distinctEntries[i] })\n    // }\n    // return ret;\n  },\n  areas: function () {\n    var countySelected = Template.instance().countySelected.get();\n\n    if (!countySelected) {\n      var c = Collections.Properties.find().count();\n      if (c > 1) return []; // This is the fix for - bug of not loading existing areas - page is designed to work with 1 prop, but when user comes to this page from myprop page, it has many results, leading to invalid countySelected\n\n      var doc = Collections.Properties.findOne();\n      if (!doc) return [];\n      Template.instance().countySelected.set(doc.address.county);\n      countySelected = doc.address.county;\n    }\n\n    var distinctEntries = _.uniq(Collections.Areas.find({\n      County: countySelected\n    }, {\n      sort: {\n        Area: 1\n      },\n      fields: {\n        Area: true\n      }\n    }).fetch().map(function (x) {\n      return x.Area;\n    }), true);\n\n    var ret = [];\n\n    for (var i = 0; i < distinctEntries.length; i++) {\n      if (!distinctEntries[i]) continue;\n      ret.push({\n        label: titleCase(distinctEntries[i]),\n        value: distinctEntries[i]\n      });\n    }\n\n    return ret; //Previous logic\n    // var Config = Collections.Config.find().fetch();Config = Config[0];\n    // var ret = []\n    // for(var i=0;i< Config.countyInfo.length;i++){\n    //     ret.push({label: titleCase(Config.countyInfo[i].area), value: Config.countyInfo[i].area})\n    // }\n  },\n  propertyTypes: function () {\n    var Config = Collections.Config.find().fetch();\n    Config = Config[0];\n    var ret = [];\n\n    for (var i = 0; i < Config.propertyType.length; i++) {\n      ret.push({\n        label: titleCase(Config.propertyType[i].name),\n        value: Config.propertyType[i].value\n      });\n    }\n\n    return ret;\n  },\n  numBedRoomCount: function () {\n    var c = Template.instance().numBedRoomCount.get();\n    if (c < 100) return Template.instance().numBedRoomCount.get();else return 0;\n  },\n  editPropertyFormSaving: function () {\n    return Template.instance().editPropertyFormSaving.get();\n  },\n  ensuiteLoop: function (count) {\n    var countArr = [];\n\n    for (var i = 0; i < count; i++) {\n      countArr.push({\n        i: i + 1\n      });\n    }\n\n    return countArr;\n  },\n  ensuiteLoopCheckbox: function (index) {\n    var doc = Collections.Properties.findOne();\n    if (doc) if (doc.bedrooms[index]) {\n      if (doc.bedrooms[index].ensuite) return 'checked';\n    }\n    return '';\n  },\n  ensuiteLoopBedType: function (index, b) {\n    var doc = Collections.Properties.findOne();\n    if (doc) if (doc.bedrooms[index]) {\n      if (doc.bedrooms[index].bedType == b) return 'selected';\n    }\n    return '';\n  },\n  leaseUntil: function () {\n    var allowedVals = ['1 month', '2 months', '3 months', '4 months', '5  months', '6 months', '7 months', '8 months', '9 months', '10 months', '11 months', '1 year', 'More than a year'];\n    return allowedVals;\n  },\n  ensuiteLoopBedTypeOptions: function (index) {\n    var doc = Collections.Properties.findOne();\n    var isSingle = false,\n        isDouble = false,\n        isTwin = false;\n    if (doc) if (doc.bedrooms) if (doc.bedrooms[index]) {\n      switch (doc.bedrooms[index].bedType) {\n        case 'single':\n          isSingle = true;\n          break;\n\n        case 'double':\n          isDouble = true;\n          break;\n\n        case 'twin':\n          isTwin = true;\n          break;\n      }\n    }\n    var arr = [{\n      label: \"Single\",\n      value: \"single\",\n      sel: isSingle ? 'selected' : ''\n    }, {\n      label: \"Double\",\n      value: \"double\",\n      sel: isDouble ? 'selected' : ''\n    }, {\n      label: \"Twin\",\n      value: \"twin\",\n      sel: isTwin ? 'selected' : ''\n    }];\n    return arr;\n  },\n  hasAmenityCheckbox: function (v) {\n    var doc = Collections.Properties.findOne();\n    if (doc) if (doc.amenities) if (doc.amenities.length) if (doc.amenities.indexOf(v) != -1) return 'checked';\n    return '';\n  },\n  propertyContact: function (i) {\n    var doc = Collections.Properties.findOne();\n    if (doc) if (doc.contacts) if (doc.contacts.length) return doc.contacts[0];\n    return {\n      name: '',\n      phone: '',\n      email: ''\n    };\n  },\n  advertisementContact: function (i) {\n    var id = FlowRouter.current().params.id;\n    var doc = Collections.Properties.findOne(id, {\n      transform: function (data) {\n        if (data.auctionId) data.auction = Collections.Auctions.findOne(data.auctionId);\n        return data;\n      },\n      limit: 1\n    });\n    if (doc) if (doc.auction) if (doc.auction.contacts) if (doc.auction.contacts.length) return doc.auction.contacts[0];\n    return {\n      name: '',\n      phone: '',\n      email: ''\n    };\n  }\n});\nTemplate.editPropertyForm.events({\n  \"click .backBtn\": function (event, template) {\n    goBack();\n  },\n  'submit form': function (event) {\n    event.preventDefault();\n  },\n  \"click .editPropertyFormSaveActivateBtn\": function (event, template) {\n    $('#editPropertyFormCF').submit();\n  },\n  \"click .editPropertyFormCancelBtn\": function (event, template) {\n    goBack();\n  },\n  'change .selectPropertyImages': function (event, template) {\n    return;\n    var files = event.target.files;\n    console.log('Upload called'); // console.log(files);\n\n    S3.upload({\n      files: files,\n      path: \"DEVpropertyImagesLarge\"\n    }, function (e, r) {\n      if (e) {\n        throw new Meteor.Error('Upload failed ', e);\n        var tmp = Session.get(\"showErrorDlg\");\n        if (!tmp) tmp = [];\n        tmp.push(\"Upload failed: please check your internet connection, contact us if needed.\");\n        Session.set(\"showErrorDlg\", tmp);\n        return;\n      }\n\n      var editPropertyImages = Session.get('editPropertyImages');\n      var editPropertyImagesNewOnes = Session.get('editPropertyImagesNewOnes');\n      var tmp = {\n        name: r.file.original_name,\n        relative_url: r.relative_url,\n        url: r.secure_url\n      };\n      editPropertyImages.push(tmp);\n      editPropertyImagesNewOnes.push(tmp);\n      Session.set('editPropertyImages', editPropertyImages);\n      Session.set('editPropertyImagesNewOnes', editPropertyImagesNewOnes);\n      var propertyData = Session.get(\"propertyData\");\n      updateGalleriesInServer(editPropertyImages, propertyData._id, function (err, res) {\n        if (err) {\n          console.log(err);\n          var tmp = Session.get(\"showErrorDlg\");\n          if (!tmp) tmp = [];\n          tmp.push(\"Upload failed: please check your internet connection, contact us if needed.\");\n          Session.set(\"showErrorDlg\", tmp);\n          return;\n        } else {\n          var editPropertyImages = Session.get('editPropertyImages');\n          console.log(\"Current Count: \" + editPropertyImages.length);\n        }\n      });\n      console.log(r);\n    });\n  },\n  'change .countySelected': function (event, template) {\n    template.countySelected.set(event.target.value);\n  },\n  \"click .openFileUploader\": function (event, template) {\n    event.preventDefault();\n    openPicker(); // filename\n    //     :\n    //     \"webcam-1/12/2018, 6:53:25 PM.png\"\n    // handle\n    //     :\n    //     \"G8lStVqHTiGnwxof6d5y\"\n    // mimetype\n    //     :\n    //     \"image/png\"\n    // originalFile\n    //     :\n    // {name: \"webcam-1/12/2018, 6:53:25 PM.png\", type: \"image/png\", size: 630585}\n    // originalPath\n    //     :\n    //     \"webcam-1/12/2018, 6:53:25 PM.png\"\n    // size\n    //     :\n    //     629612\n    // source\n    //     :\n    //     \"local_file_system\"\n    // status\n    //     :\n    //     \"Stored\"\n    // uploadId\n    //     :\n    //     \"ba2fe36e9fd182ec0cb88236d676cefad\"\n    // url\n    //     :\n    //     \"https://cdn.filestackcontent.com\n\n    return;\n  },\n  'keyup .autoGrowTA': function (event, template) {\n    var element = event.target;\n    element.style.height = \"5px\";\n    if (element.scrollHeight < 310) element.style.height = element.scrollHeight + \"px\";else element.style.height = \"310px\";\n  },\n  'change #numBedRoomCount': function (event, template) {\n    var numBedRoomCount = parseInt($(event.target).val());\n    if (isNaN(numBedRoomCount)) return;\n    Template.instance().numBedRoomCount.set(numBedRoomCount);\n    t1 = template;\n    setTimeout(function () {\n      t1.$('#editPropertyFormCF').validate();\n    }, 500);\n  }\n});\nTemplate.editPropertyForm.onRendered(function () {\n  this.$('#readyFrom').datetimepicker();\n  var element = this.$('.autoGrowTA')[0];\n  if (element.scrollHeight < 310) element.style.height = element.scrollHeight + \"px\";else element.style.height = \"310px\"; // this.$('#editPropertyFormCF').validate();\n\n  editPropertyFormSaving = this.editPropertyFormSaving;\n  var validator = this.$('#editPropertyFormCF').validate({\n    submitHandler: function (event) {\n      editPropertyFormSaving.set(true);\n      console.log(\"You just submitted the 'editPropertyForm' form.\");\n      var doc = Collections.Properties.findOne();\n\n      if (doc) {\n        Meteor.call('editProperty', doc._id, $('#editPropertyFormCF').serializeArray(), function (error, result) {\n          editPropertyFormSaving.set(false);\n\n          if (error) {\n            console.log(error); //    validator.showErrors({\n            //         email: error.reason\n            //     });\n\n            var tmp = Session.get(\"showErrorDlg\");\n            if (!tmp) tmp = [];\n            var msg = 'An error occurred.';\n            if (error.reason) msg += ' ' + error.reason + '.';else if (error.message) msg += ' ' + error.message + '.';\n            tmp.push(msg);\n            Session.set(\"showErrorDlg\", tmp);\n            return;\n          }\n\n          var propertyData = Session.get(\"propertyData\");\n          var editPropertyImages = Session.get('editPropertyImages');\n\n          if (!editPropertyImages) {\n            Session.set('editPropertyImages', []);\n            S3.collection.remove({});\n            goBack();\n          } else {\n            updateGalleriesInServer(editPropertyImages, propertyData._id, function (err, res) {\n              if (err) {\n                console.log(err);\n              } else {\n                Session.set('editPropertyImages', []);\n                S3.collection.remove({});\n              }\n\n              goBack();\n            });\n          }\n\n          Session.set('hideAddPropertyForm', true);\n        });\n      }\n    }\n  });\n\n  if (Session.get('OpenImageUploader')) {\n    scrollTo('.openFileUploader', 0, 500);\n    openPicker();\n    Session.set('OpenImageUploader', false);\n  }\n});\nTemplate.imageEditView.helpers({\n  images: function () {\n    // var propertyData = Session.get('propertyData');\n    // var existingGallery = propertyData.gallery;\n    // var editPropertyImages = Session.get('editPropertyImages');\n    // if(!editPropertyImages)editPropertyImages=[]\n    // if(!existingGallery )existingGallery =[]\n    // var newCombined = editPropertyImages.concat(existingGallery);\n    return Session.get('editPropertyImages');\n  }\n});\nTemplate.imgEditTag.events({\n  \"click .editImgBtn\": function (event, template) {\n    console.log(this);\n    debugger;\n    var editPropertyImages = Session.get('editPropertyImages');\n    var editPropertyImagesNewOnes = Session.get('editPropertyImagesNewOnes');\n    var isOriginalImageFromOwnS3 = false;\n    var newArr = [];\n    if (!editPropertyImages) return;\n    if (!editPropertyImages.length) return;\n\n    if (this.handle) {\n      index = getIndexByHandle(editPropertyImages, this.handle);\n    } else {\n      isOriginalImageFromOwnS3 = true;\n      index = getIndexByRelativeURL(editPropertyImages, this.relative_url);\n    }\n\n    newArr.push(editPropertyImages[index].url); //put it at first\n    // editPropertyImages.splice(index, 1);\n    //\n    // for(var i=0;i<editPropertyImages.length;i++){\n    //     newArr.push(editPropertyImages[i].url)\n    // }\n\n    const pickOptions = {\n      transformations: {\n        crop: {\n          force: true,\n          aspectRatio: 1.333\n        },\n        rotate: true\n      },\n      accept: 'image/*',\n      imageMax: [800, 600]\n    };\n    fsClient.cropFiles(newArr, pickOptions).then(response => {\n      debugger;\n      var editPropertyImages = Session.get('editPropertyImages');\n      var editPropertyImagesNewOnes = Session.get('editPropertyImagesNewOnes'); //if its conversion from old amazon to new filestack, then it will create a new file, so delete the old file seperatly and insert a new file seperatly.\n\n      if (!response.filesUploaded.length) {\n        var tmp = Session.get(\"showErrorDlg\");\n        if (!tmp) tmp = [];\n        tmp.push(\"Edit failed: please try again, contact us if needed.\");\n        Session.set(\"showErrorDlg\", tmp);\n        return;\n      }\n\n      if (isOriginalImageFromOwnS3) {\n        S3.delete(editPropertyImages[index].relative_url, function (error, result) {\n          if (error) {\n            var tmp = Session.get(\"showErrorDlg\");\n            if (!tmp) tmp = [];\n            tmp.push(\"Edit failed: please check your internet connection, contact us if needed.\");\n            Session.set(\"showErrorDlg\", tmp);\n            return;\n          }\n\n          var editPropertyImages = Session.get('editPropertyImages');\n          editPropertyImages.splice(index, 1);\n          Session.set('editPropertyImages', editPropertyImages);\n          var propertyData = Session.get(\"propertyData\");\n          updateGalleriesInServer(editPropertyImages, propertyData._id, function (err, res) {\n            if (err) {\n              console.log(err);\n              var tmp = Session.get(\"showErrorDlg\");\n              if (!tmp) tmp = [];\n              tmp.push(\"Edit failed: please check your internet connection, contact us if needed.\");\n              Session.set(\"showErrorDlg\", tmp);\n              return;\n            } else {\n              var editPropertyImages = Session.get('editPropertyImages');\n              console.log(\"Current Count: \" + editPropertyImages.length);\n            }\n          });\n        });\n      } else {\n        fsClient.remove(editPropertyImages[index].handle).then(function (result) {\n          debugger;\n          console.log('In fs remove result');\n          var editPropertyImages = Session.get('editPropertyImages');\n          editPropertyImages.splice(index, 1);\n          Session.set('editPropertyImages', editPropertyImages);\n          var propertyData = Session.get(\"propertyData\");\n          updateGalleriesInServer(editPropertyImages, propertyData._id, function (err, res) {\n            if (err) {\n              console.log(err);\n              var tmp = Session.get(\"showErrorDlg\");\n              if (!tmp) tmp = [];\n              tmp.push(\"Edit failed: please check your internet connection, contact us if needed.\");\n              Session.set(\"showErrorDlg\", tmp);\n              return;\n            } else {\n              var editPropertyImages = Session.get('editPropertyImages');\n              console.log(\"Current Count: \" + editPropertyImages.length);\n            }\n          });\n        });\n      }\n\n      var tmp = {};\n\n      for (var i = 0; i < response.filesUploaded.length; i++) {\n        tmp = {\n          name: response.filesUploaded[i].filename,\n          url: response.filesUploaded[i].url,\n          handle: response.filesUploaded[i].handle,\n          mimetype: response.filesUploaded[i].mimetype,\n          originalFile: response.filesUploaded[i].originalFile,\n          originalPath: response.filesUploaded[i].originalPath,\n          size: response.filesUploaded[i].size,\n          source: response.filesUploaded[i].source,\n          status: response.filesUploaded[i].status,\n          uploadId: response.filesUploaded[i].uploadId\n        }; // editPropertyImages.push(tmp);\n\n        editPropertyImages.splice(index + 1, 0, tmp); //insert at the index place where its deleted.\n\n        editPropertyImagesNewOnes.push(tmp);\n      } //Logic to insert new file.\n\n\n      Session.set('editPropertyImages', editPropertyImages);\n      var propertyData = Session.get(\"propertyData\");\n      updateGalleriesInServer(editPropertyImages, propertyData._id, function (err, res) {\n        if (err) {\n          console.log(err);\n          var tmp = Session.get(\"showErrorDlg\");\n          if (!tmp) tmp = [];\n          tmp.push(\"Edit failed: please check your internet connection, contact us if needed.\");\n          Session.set(\"showErrorDlg\", tmp);\n          return;\n        } else {\n          var editPropertyImages = Session.get('editPropertyImages');\n          console.log(\"Current Count: \" + editPropertyImages.length);\n        }\n      });\n    });\n  },\n  \"click .deleteImgBtn\": function (event, template) {\n    console.log(this);\n    debugger;\n    var editPropertyImages = Session.get('editPropertyImages'); // editPropertyImages.splice(index, 1);\n    // Session.set('editPropertyImages',editPropertyImages);\n\n    if (this.handle) {\n      index = getIndexByHandle(editPropertyImages, this.handle);\n      fsClient.remove(this.handle).then(function (result) {\n        debugger;\n        console.log('In fs remove result');\n        var editPropertyImages = Session.get('editPropertyImages');\n        editPropertyImages.splice(index, 1);\n        Session.set('editPropertyImages', editPropertyImages);\n        var propertyData = Session.get(\"propertyData\");\n        updateGalleriesInServer(editPropertyImages, propertyData._id, function (err, res) {\n          if (err) {\n            console.log(err);\n            var tmp = Session.get(\"showErrorDlg\");\n            if (!tmp) tmp = [];\n            tmp.push(\"Deletion failed: please check your internet connection, contact us if needed.\");\n            Session.set(\"showErrorDlg\", tmp);\n            return;\n          } else {\n            var editPropertyImages = Session.get('editPropertyImages');\n            console.log(\"Current Count: \" + editPropertyImages.length);\n          }\n        });\n      });\n    } else {\n      index = getIndexByRelativeURL(editPropertyImages, this.relative_url);\n      S3.delete(this.relative_url, function (error, result) {\n        if (error) {\n          var tmp = Session.get(\"showErrorDlg\");\n          if (!tmp) tmp = [];\n          tmp.push(\"Deletion failed: please check your internet connection, contact us if needed.\");\n          Session.set(\"showErrorDlg\", tmp);\n          return;\n        }\n\n        var editPropertyImages = Session.get('editPropertyImages');\n        editPropertyImages.splice(index, 1);\n        Session.set('editPropertyImages', editPropertyImages);\n        var propertyData = Session.get(\"propertyData\");\n        updateGalleriesInServer(editPropertyImages, propertyData._id, function (err, res) {\n          if (err) {\n            console.log(err);\n            var tmp = Session.get(\"showErrorDlg\");\n            if (!tmp) tmp = [];\n            tmp.push(\"Deletion failed: please check your internet connection, contact us if needed.\");\n            Session.set(\"showErrorDlg\", tmp);\n            return;\n          } else {\n            var editPropertyImages = Session.get('editPropertyImages');\n            console.log(\"Current Count: \" + editPropertyImages.length);\n          }\n        });\n      });\n    }\n  }\n});\n\nfunction openPicker() {\n  fsClient.pick({\n    fromSources: [\"local_file_system\", \"webcam\", \"facebook\", \"url\", \"googledrive\", \"dropbox\", \"flickr\", \"instagram\", \"gmail\", \"picasa\", \"onedrive\", \"clouddrive\"],\n    maxFiles: 10,\n    transformations: {\n      crop: {\n        force: true,\n        aspectRatio: 1.333\n      },\n      rotate: true\n    },\n    imageMax: [800, 600],\n    accept: [\"image/*\"] //,\".pdf\",\".doc\",\".docx\",\".docm\"\n\n  }).then(function (response) {\n    // declare this function to handle response\n    debugger;\n    var editPropertyImages = Session.get('editPropertyImages');\n    var editPropertyImagesNewOnes = Session.get('editPropertyImagesNewOnes');\n    var tmp = {};\n    if (response.filesUploaded) for (var i = 0; i < response.filesUploaded.length; i++) {\n      tmp = {\n        name: response.filesUploaded[i].filename,\n        url: response.filesUploaded[i].url,\n        handle: response.filesUploaded[i].handle,\n        mimetype: response.filesUploaded[i].mimetype,\n        originalFile: response.filesUploaded[i].originalFile,\n        originalPath: response.filesUploaded[i].originalPath,\n        size: response.filesUploaded[i].size,\n        source: response.filesUploaded[i].source,\n        status: response.filesUploaded[i].status,\n        uploadId: response.filesUploaded[i].uploadId\n      };\n      editPropertyImages.push(tmp);\n      editPropertyImagesNewOnes.push(tmp);\n    }\n    Session.set('editPropertyImages', editPropertyImages);\n    Session.set('editPropertyImagesNewOnes', editPropertyImagesNewOnes);\n    var propertyData = Session.get(\"propertyData\");\n    updateGalleriesInServer(editPropertyImages, propertyData._id, function (err, res) {\n      if (err) {\n        console.log(err);\n        var tmp = Session.get(\"showErrorDlg\");\n        if (!tmp) tmp = [];\n        tmp.push(\"Upload failed: please check your internet connection, contact us if needed.\");\n        Session.set(\"showErrorDlg\", tmp);\n        return;\n      } else {\n        var editPropertyImages = Session.get('editPropertyImages');\n        console.log(\"Current Count: \" + editPropertyImages.length);\n\n        if (Session.get('fromAdvertiseWithUsPage')) {\n          fbq('track', 'CompleteRegistration');\n          ga('send', 'event', 'AdvertiseWithUsPage', 'ImageUploaded', 'Property Images Uploaded.');\n          Session.set('fromAdvertiseWithUsPage', false);\n        }\n      }\n    });\n    console.log(response);\n  });\n}\n\nfunction goBack() {\n  var prevRoute = Session.get('prevRoute');\n\n  if (prevRoute) {\n    FlowRouter.go(prevRoute.name, prevRoute.args);\n    Session.set('prevRoute', false);\n\n    if (prevRoute.scrollTo) {\n      scrollTo(prevRoute.scrollTo, 0, 500);\n    }\n  } else {\n    FlowRouter.go(\"/account/myproperies/\", {\n      pageno: 1\n    });\n  }\n}\n\nfunction getpropertyData() {\n  var id = FlowRouter.current().params.id;\n  var ret = Collections.Properties.find(id, {\n    transform: function (data) {\n      data.auction = Collections.Auctions.findOne(data.auctionId);\n      data.applicationsReceivedCount = Collections.Bids.find({\n        auctionId: data.auctionId\n      }).count();\n      data.applicationsActiveCount = Collections.Bids.find({\n        auctionId: data.auctionId,\n        isArchived: false\n      }).count();\n      return data;\n    },\n    limit: 1\n  }).fetch(); // console.log(\"getProjectData\");\n\n  return ret[0];\n}\n\nfunction getIndexByHandle(myArray, fileId) {\n  for (var i = 0; i < myArray.length; i++) {\n    if (myArray[i].handle === fileId) {\n      return i;\n    }\n  }\n}\n\nfunction getIndexByRelativeURL(myArray, fileId) {\n  for (var i = 0; i < myArray.length; i++) {\n    if (myArray[i].relative_url === fileId) {\n      return i;\n    }\n  }\n}\n\nfunction attachEvents() {\n  $(\".deactivateConfirmBtn\").unbind().bind(\"click\", function () {\n    deactivateConfEvent();\n  });\n  $(\".archiveConfirmBtn\").unbind().bind(\"click\", function () {\n    archiveConfEvent();\n  });\n  $(\".closePopupBtn\").unbind().bind(\"click\", function () {\n    closePopupEvent();\n  });\n}\n\nfunction deactivateConfEvent() {\n  var data = Session.get(\"propertyData\");\n  var auctionId = data.auctionId;\n  deactivateInProgress.set(true);\n  Meteor.call('deactivateAuction', auctionId, function (error, result) {\n    deactivateInProgress.set(false);\n\n    if (error) {\n      console.log(error);\n      var tmp = Session.get(\"showErrorDlg\");\n      if (!tmp) tmp = [];\n      tmp.push(\"Failed deactivating. Please try again, try checking your internet connectivity. Contact us if needed.\");\n      Session.set(\"showErrorDlg\", tmp);\n      return;\n    }\n\n    console.log(\"Success\");\n    var prevRoute = Session.get('prevRoute');\n    closePopupEvent();\n    goBack();\n  });\n}\n\nfunction archiveConfEvent() {\n  var data = Session.get(\"propertyData\");\n  var propertyId = data._id;\n  archiveInProgress.set(true);\n  Meteor.call('archiveProperty', propertyId, function (error, result) {\n    archiveInProgress.set(false);\n\n    if (error) {\n      console.log(error);\n      var tmp = Session.get(\"showErrorDlg\");\n      if (!tmp) tmp = [];\n      tmp.push(\"Failed archiving. Please try again, try checking your internet connectivity. Contact us if needed.\");\n      Session.set(\"showErrorDlg\", tmp);\n      return;\n    }\n\n    console.log(\"Success\");\n    var prevRoute = Session.get('prevRoute');\n    closePopupEvent();\n    goBack();\n  });\n}\n\nfunction closePopupEvent() {\n  console.log('closePopupEvent');\n  if ($) if ($.fancybox) $.fancybox.close();\n}\n\nfunction titleCase(str) {\n  if (!str) return;\n  return str.charAt(0).toUpperCase() + str.toLowerCase().substring(1);\n}\n\nfunction slugifyEmailAddress(text) {\n  if (!text) return '';\n  const a = 'àáäâèéëêìíïîòóöôùúüûñçßÿœæŕśńṕẃǵǹḿǘẍźḧ/_,:;';\n  const b = 'aaaaeeeeiiiioooouuuuncsyoarsnpwgnmuxzh------';\n  const p = new RegExp(a.split('').join('|'), 'g');\n  return text.toString().toLowerCase().replace(/\\s+/g, '.') // Replace spaces with \".\"\n  .replace(p, c => b.charAt(a.indexOf(c))) // Replace special chars\n  .replace(/&/g, '-and-') // Replace & with ''\n  // .replace(/[^\\w\\-]+/g, '')       // Remove all non-word chars\n  .replace(/\\-\\-+/g, '-') // Replace multiple - with single ''\n  .replace(/^-+/, '') // Trim - from start of text\n  .replace(/-+$/, ''); // Trim - from end of text\n}","map":{"version":3,"sources":["imports/ui/templates/editProperty.js"],"names":["module","link","filestack","default","v","apikey","fsClient","init","policy","signature","Template","editProperty","onCreated","instance","isSubsLoaded","ReactiveVar","autorun","subscribe","id","FlowRouter","getParam","subscriptionsReady","set","deactivateInProgress","archiveInProgress","helpers","userLoggedIn","Meteor","user","propertyData","current","params","ret","Collections","Properties","find","transform","data","globalConfig","Config","findOne","auctionId","auction","Auctions","limit","fetch","clearMeta","title","address","area","county","DocHead","setTitle","titleCase","addMeta","name","content","type","err","Session","propertyFound","c","count","inIgnoreList","str","ignoreList","indexOf","get","onRendered","jQuery","animate","scrollTop","e","document","body","documentElement","events","event","template","preventDefault","console","log","createdByAgent","_id","$","fancybox","afterShow","attachEvents","afterClose","goBack","target","value","tmp","split","trim","match","Array","isArray","join","sluggedName","slugifyEmailAddress","profile","email","lettingAuctionCode","toLowerCase","val","url","key","select","unbind","bind","successful","execCommand","msg","close","ga","editPropertyForm","S3","collection","remove","numBedRoomCount","editPropertyFormSaving","countySelected","gallery","results","doc","bedrooms","length","trimVal","isEqualSelect","a","b","isEqualCheck","furnishedOptions","isFurnished","label","selected","countries","counties","staticCounties","i","push","areas","distinctEntries","_","uniq","Areas","County","sort","Area","fields","map","x","propertyTypes","propertyType","ensuiteLoop","countArr","ensuiteLoopCheckbox","index","ensuite","ensuiteLoopBedType","bedType","leaseUntil","allowedVals","ensuiteLoopBedTypeOptions","isSingle","isDouble","isTwin","arr","sel","hasAmenityCheckbox","amenities","propertyContact","contacts","phone","advertisementContact","submit","files","upload","path","r","Error","editPropertyImages","editPropertyImagesNewOnes","file","original_name","relative_url","secure_url","updateGalleriesInServer","res","openPicker","element","style","height","scrollHeight","parseInt","isNaN","t1","setTimeout","validate","datetimepicker","validator","submitHandler","call","serializeArray","error","result","reason","message","scrollTo","imageEditView","images","imgEditTag","isOriginalImageFromOwnS3","newArr","handle","getIndexByHandle","getIndexByRelativeURL","pickOptions","transformations","crop","force","aspectRatio","rotate","accept","imageMax","cropFiles","then","response","filesUploaded","delete","splice","filename","mimetype","originalFile","originalPath","size","source","status","uploadId","pick","fromSources","maxFiles","fbq","prevRoute","go","args","pageno","getpropertyData","applicationsReceivedCount","Bids","applicationsActiveCount","isArchived","myArray","fileId","deactivateConfEvent","archiveConfEvent","closePopupEvent","propertyId","charAt","toUpperCase","substring","text","p","RegExp","toString","replace"],"mappings":"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","sourcesContent":["/**\n * Created by njanjanam on 11/05/2017.\n */\nimport \"./imageView.html\";\nimport \"./editProperty.html\";\nimport './shared.js';\nimport filestack from 'filestack-js';\nconst apikey = 'AIPACLEs7ShGwwPh6fMTxz';\nconst fsClient = filestack.init(apikey,{\n    policy: 'eyJleHBpcnkiOjE4NjE5MjAwMDAsImNhbGwiOlsicGljayIsInJlYWQiLCJzdGF0Iiwid3JpdGUiLCJ3cml0ZVVybCIsInN0b3JlIiwiY29udmVydCIsInJlbW92ZSIsImV4aWYiXX0=',\n    signature: '465e8652c5cef95f44e5858e09d430abea855d98deaeb7425558f2c80d0f4f57'\n});\n// import SimpleSchema from \"simpl-schema\";\n// SimpleSchema.extendOptions(['autoform']);\n\n\n\nTemplate.editProperty.onCreated(function(){\n    // this.showEditProperty = new ReactiveVar( false );\n    // console.log(this.data.propertyData)\n    // debugger;\n    var instance = this;\n    instance.isSubsLoaded = new ReactiveVar(false);\n    instance.autorun(function(){\n\n        instance.subscribe('Config');\n        var id = FlowRouter.getParam('id');\n        instance.subscribe('editProperty',id);\n        instance.subscribe('Areas');//Let it wait in edit prop page\n        instance.subscribe('userData');\n\n        if(instance.subscriptionsReady()){\n            instance.isSubsLoaded.set(true)\n        }\n    })\n\n    this.deactivateInProgress = new ReactiveVar( false );\n    this.archiveInProgress = new ReactiveVar( false );\n    // Session.set('editPropertyImagesNewOnes',[]);\n    // var gallery = this.data.propertyData.gallery;\n    // if(!gallery)gallery=[]\n    // Session.set('editPropertyImages',gallery);\n})\nTemplate.editProperty.helpers({\n    // showEditProperty: function () {\n    //     return Template.instance().showEditProperty.get();\n    // },\n    // propertyData : function () {\n    //     var ret = getpropertyData();\n    //     // console.log(\"propertyData\");\n    //     // console.log(ret);\n    //     Session.set('propertyData',ret);\n    //     return ret;\n    // },\n    isSubsLoaded:function(){\n        return Template.instance().subscriptionsReady();\n    },\n    userLoggedIn:function(){\n        if(Meteor.user())return true;\n        return false;\n    },\n    propertyData: function () {\n        // debugger;\n\n\n        var id = FlowRouter.current().params.id;\n        var ret = Collections.Properties.find(id, {\n            transform: function (data) {\n\n                var globalConfig = Collections.Config.findOne();\n                if(data.auctionId)data.auction = Collections.Auctions.findOne(data.auctionId);\n\n                return data;\n            },\n            limit: 1\n        }).fetch();\n        ret = ret[0];\n\n        clearMeta();\n        try {\n            var title = 'Editing ' + ret.address.address + ', ' + ret.address.area;\n            if (ret.address.county) title += ', ' + ret.address.county;\n\n            DocHead.setTitle('' + titleCase(title) + ' | SpotMyCrib Admin');\n            DocHead.addMeta({\n                name: \"description\",\n                content: \"Edit property \" + ret.type + \", upload its images, details and much more.\"\n            });\n        }catch(err){\n            DocHead.setTitle(' Property not found | SpotMyCrib Admin');\n            DocHead.addMeta({name: \"description\", content: \"\"});\n        }\n\n        Session.set(\"propertyData\", ret);\n        return ret;\n        // return {propertyData: ret};\n    },\n    propertyFound:function(){\n        var c = Collections.Properties.find().count()\n        if(c)return true;\n        return false;\n    },\n    inIgnoreList:function (str) {\n        ignoreList = ['gallery','isArchived']\n        if(ignoreList.indexOf(str) !== -1)return true;\n        return false;\n    },\n    deactivateInProgress: function(){\n        deactivateInProgress = Template.instance().deactivateInProgress;\n        return Template.instance().deactivateInProgress.get() ;\n    },\n    archiveInProgress: function(){\n        archiveInProgress = Template.instance().archiveInProgress;\n        return Template.instance().archiveInProgress.get() ;\n    },\n    // getGallery:function () {\n    //     // debugger;\n    //     var propertyData = Session.get('propertyData');\n    //     return propertyData.gallery;\n    // }\n})\nTemplate.editProperty.onRendered(function() {\n    try{\n        jQuery(\"html,body\").animate({scrollTop: 0}, 250);\n    }catch(e){\n        document.body.scrollTop = document.documentElement.scrollTop = 0;\n    }\n\n\n\n})\n\nTemplate.editProperty.events({\n    \"click .deactivatePropertyBtn\": function (event, template) {\n        event.preventDefault();\n        var propertyData = Session.get('propertyData');\n        if(!propertyData){\n            console.log(\"Empty project data\");\n            return false;}\n        var user = Meteor.user();\n        if(!user){console.log(\"Invalid user\");return;}\n        if(propertyData.createdByAgent != user._id){console.log(\"Invalid user\");return;}\n\n        $.fancybox({\n            'padding': 0,\n            'href': '#conf-dactivate-pop',\n            afterShow:function(template){\n                attachEvents();\n            },\n            afterClose:function(template){\n                console.log(template);\n            }\n        })\n    },\n    \"click .archivePropertyBtn\": function (event, template) {\n        event.preventDefault();\n        var propertyData = Session.get('propertyData');\n        if(!propertyData){\n            console.log(\"Empty project data\");\n            return false;}\n        var user = Meteor.user();\n        if(!user){console.log(\"Invalid user\");return;}\n        if(propertyData.createdByAgent != user._id){console.log(\"Invalid user\");return;}\n\n        $.fancybox({\n            'padding': 0,\n            'href': '#conf-archive-pop',\n            afterShow:function(template){\n                attachEvents();\n            },\n            afterClose:function(template){\n                console.log(template);\n            }\n        })\n    },\n    // 'change .selectPropertyImages': function(event, template) {\n    //     var files = event.target.files;\n    //     S3.upload({\n    //         files:files,\n    //         path:\"propertyImagesLarge\"\n    //     },function(e,r){\n    //         if(e){\n    //             throw new Meteor.Error('Upload failed ', e);\n    //             var tmp =  Session.get(\"showErrorDlg\");if(!tmp)tmp=[];\n    //             tmp.push(\"Upload failed: please check your internet connection, contact us if needed.\");\n    //             Session.set(\"showErrorDlg\",tmp)\n    //             return;\n    //         }\n    //         var editPropertyImages = Session.get('editPropertyImages');\n    //         var editPropertyImagesNewOnes = Session.get('editPropertyImagesNewOnes');\n    //         var tmp = {\n    //             name: r.file.original_name,\n    //             relative_url: r.relative_url,\n    //             url: r.secure_url\n    //         };\n    //         editPropertyImages.push(tmp);\n    //         editPropertyImagesNewOnes.push(tmp);\n    //         Session.set('editPropertyImages',editPropertyImages);\n    //         Session.set('editPropertyImagesNewOnes',editPropertyImagesNewOnes);\n    //         var propertyData = Session.get(\"propertyData\");\n    //         updateGalleriesInServer(editPropertyImages,propertyData._id, function (err, res) {\n    //             if (err) {\n    //                 console.log(err);\n    //                 var tmp =  Session.get(\"showErrorDlg\");if(!tmp)tmp=[];\n    //                 tmp.push(\"Upload failed: please check your internet connection, contact us if needed.\");\n    //                 Session.set(\"showErrorDlg\",tmp)\n    //                 return;\n    //             } else {\n    //                 var editPropertyImages = Session.get('editPropertyImages');\n    //                 console.log(\"Current Count: \"+editPropertyImages.length )\n    //             }\n    //         });\n    //         console.log(r);\n    //     });\n    // },\n    \"click .backBtn\": function(event, template){\n        goBack();\n    },\n    'change input[name=price]':function(event, template){\n        if(event.target.value){\n            var tmp = event.target.value.split('.');tmp=tmp[0]//No decimals\n            tmp = tmp.trim().match(/\\d+/g)\n            if(!Array.isArray(tmp))event.target.value = '';\n            event.target.value = tmp.join('');\n        }\n    },\n    \"click .showCopyDlg\": function (event, template) {\n        var propertyData = Session.get('propertyData');\n\n        let user = Meteor.user();\n        let sluggedName = slugifyEmailAddress(user.profile.name);\n        if(!sluggedName)sluggedName = 'rent'\n        let email = sluggedName+'-let-'+propertyData.auction.lettingAuctionCode.toLowerCase()+\"@spotmycrib.ie\";\n        $('#agentPropertyEmailField').val(email);\n\n        var url = FlowRouter.url('letting',{key:propertyData.auction.lettingAuctionCode})\n        $('#propertyLinkField').val(url);\n        $.fancybox({\n            'padding': 0,\n            'href': '#propertyLinkDlg',\n            afterShow:function(template){\n                $('#agentPropertyEmailField').select();\n                $('#propertyLinkDlg .copyEmailBtn').unbind().bind('click',function () {\n                    $('#agentPropertyEmailField').select();\n\n                    try {\n                        var successful = document.execCommand('copy');\n                        var msg = successful ? 'successful' : 'unsuccessful';\n                        // console.log('Copying text command was ' + msg);\n                        $.fancybox.close()\n                    } catch (err) {\n                        console.log('Oops, unable to copy');\n                    }\n                    ga('send', 'event', 'editPropertyPage', 'copyShareEmail', 'copyShareEmail Btn Clicked');\n                })\n                $('#propertyLinkDlg .copyLinkBtn').unbind().bind('click',function () {\n                    $('#propertyLinkField').select();\n\n                    try {\n                        var successful = document.execCommand('copy');\n                        var msg = successful ? 'successful' : 'unsuccessful';\n                        // console.log('Copying text command was ' + msg);\n                        $.fancybox.close()\n                    } catch (err) {\n                        console.log('Oops, unable to copy');\n                    }\n                    ga('send', 'event', 'editPropertyPage', 'copyShareLink', 'copyShareLink Btn Clicked');\n                })\n                $('#propertyLinkDlg .cancelBtn').unbind().bind('click',function () {\n                    $.fancybox.close()\n                })\n            },\n        });\n\n    },\n})\nTemplate.editPropertyForm.onCreated(function(){\n    if(!Session.get('editPropertyImages')) {// Lets do this. Anyways we have delete button.\n        Session.set('editPropertyImages', []);\n        S3.collection.remove({})\n    }\n    this.numBedRoomCount = new ReactiveVar( 0 );\n    this.editPropertyFormSaving = new ReactiveVar( false );\n    this.countySelected = new ReactiveVar( false );\n\n    var instance = this;\n    instance.isSubsLoaded = new ReactiveVar(false);\n    instance.autorun(function(){\n        if(instance.countySelected.get()){\n            instance.isSubsLoaded.set(false)\n            instance.subscribe('Areas','','',instance.countySelected.get(),'','');\n        }\n        if(instance.subscriptionsReady()){\n            instance.isSubsLoaded.set(true)\n        }\n    })\n\n    Session.set('editPropertyImagesNewOnes',[]);\n    var gallery = []\n    try{gallery = this.data.propertyData.gallery;}catch(e){gallery=[]}\n    Session.set('editPropertyImages',gallery);\n})\nTemplate.editPropertyForm.helpers({\n    'data':function(){\n        var user = Meteor.user();\n        if(!user) return {\n            results: []\n        }\n        var id = FlowRouter.current().params.id;\n        var doc = Collections.Properties.findOne(id,{\n            transform: function (data) {\n                if(data.auctionId)data.auction = Collections.Auctions.findOne(data.auctionId);\n                return data;\n            },\n            limit: 1\n        })\n        if(doc)if(doc.bedrooms)\n        Template.instance().numBedRoomCount.set(doc.bedrooms.length);\n\n        if(doc)\n        if(doc.gallery)Session.set('editPropertyImages',doc.gallery);//This will re-run everytime u update an images and data gets fetched again.\n\n        return doc;\n    },\n    trimVal:function (str) {\n        return str.trim();\n    },\n    isEqualSelect:function (a,b) {\n        if(a==b)return 'selected';\n        return '';\n    },\n    isEqualCheck:function (a,b) {\n        if(a==b)return 'checked';\n        return '';\n    },\n    furnishedOptions:function(isFurnished){\n        return [{label: \"yes\", value: \"true\",selected:isFurnished?'selected':''},{label: \"No\", value: \"false\",selected:!isFurnished?'selected':''}];\n    },\n    countries:function(){\n        return [{label: \"Ireland\", value: \"Ireland\", selected:\"selected\"}];//Both capital\n    },\n    counties:function(){\n        let staticCounties = [\"Carlow\", \"Cavan\", \"Clare\", \"Cork\", \"Donegal\", \"Dublin\", \"Galway\", \"Kerry\", \"Kildare\", \"Kilkenny\", \"Laois\", \"Leitrim\", \"Limerick\", \"Longford\", \"Louth\", \"Mayo\", \"Meath\", \"Monaghan\", \"Offaly\", \"Roscommon\", \"Sligo\", \"Tipperary\", \"Waterford\", \"Westmeath\", \"Wexford\", \"Wicklow\"];\n        let ret = []\n        for(let i=0;i< staticCounties.length;i++){\n            if(!staticCounties[i])continue;\n            ret.push({label: titleCase(staticCounties[i]), value: staticCounties[i] })\n        }\n        return ret;\n        // return [{label: \"Dublin\", value: \"dublin\"}];//Both capital\n        // var distinctEntries = _.uniq(Collections.Areas.find({}, {\n        //     sort: {County: 1}, fields: {County: true}\n        // }).fetch().map(function(x) {\n        //     return x.County;\n        // }), true);\n        // var ret = []\n        // for(var i=0;i< distinctEntries.length;i++){\n        //     if(!distinctEntries[i])continue;\n        //     ret.push({label: titleCase(distinctEntries[i]), value: distinctEntries[i] })\n        // }\n        // return ret;\n    },\n    areas:function(){\n        var countySelected = Template.instance().countySelected.get();\n        if(!countySelected){\n            var c = Collections.Properties.find().count();\n            if(c>1)return [] // This is the fix for - bug of not loading existing areas - page is designed to work with 1 prop, but when user comes to this page from myprop page, it has many results, leading to invalid countySelected\n            var doc = Collections.Properties.findOne(); if(!doc)return [];\n            Template.instance().countySelected.set(doc.address.county);\n            countySelected = doc.address.county;\n        }\n\n        var distinctEntries = _.uniq(Collections.Areas.find({County:countySelected}, {\n            sort: {Area: 1}, fields: {Area: true}\n        }).fetch().map(function(x) {\n            return x.Area;\n        }), true);\n        var ret = []\n        for(var i=0;i< distinctEntries.length;i++){\n            if(!distinctEntries[i])continue;\n            ret.push({label: titleCase(distinctEntries[i]), value: distinctEntries[i] })\n        }\n        return ret;\n        //Previous logic\n        // var Config = Collections.Config.find().fetch();Config = Config[0];\n        // var ret = []\n        // for(var i=0;i< Config.countyInfo.length;i++){\n        //     ret.push({label: titleCase(Config.countyInfo[i].area), value: Config.countyInfo[i].area})\n        // }\n    },\n    propertyTypes:function(){\n        var Config = Collections.Config.find().fetch();Config = Config[0];\n        var ret = []\n        for(var i=0;i< Config.propertyType.length;i++){\n            ret.push({label: titleCase(Config.propertyType[i].name), value: Config.propertyType[i].value})\n        }\n        return ret;\n    },\n    numBedRoomCount:function () {\n        var c = Template.instance().numBedRoomCount.get();\n        if(c<100)return Template.instance().numBedRoomCount.get();\n        else return 0;\n    },\n    editPropertyFormSaving:function () {\n        return Template.instance().editPropertyFormSaving.get();\n    },\n    ensuiteLoop: function(count){\n        var countArr = [];\n        for (var i=0; i<count; i++){\n            countArr.push({i:i+1});\n        }\n        return countArr;\n    },\n    ensuiteLoopCheckbox :function (index) {\n        var doc = Collections.Properties.findOne()\n        if(doc)if(doc.bedrooms[index]){\n            if(doc.bedrooms[index].ensuite)return 'checked';\n        }\n        return '';\n    },\n    ensuiteLoopBedType :function (index , b) {\n        var doc = Collections.Properties.findOne()\n        if(doc)if(doc.bedrooms[index]){\n            if(doc.bedrooms[index].bedType == b)return 'selected';\n        }\n        return '';\n    },\n    leaseUntil:function () {\n        var allowedVals = ['1 month', '2 months', '3 months', '4 months', '5  months', '6 months', '7 months', '8 months', '9 months', '10 months', '11 months', '1 year', 'More than a year'];\n        return allowedVals;\n    },\n    ensuiteLoopBedTypeOptions:function(index){\n        var doc = Collections.Properties.findOne();\n        var isSingle= false,isDouble= false,isTwin = false;\n        if(doc)if(doc.bedrooms)if(doc.bedrooms[index]){\n            switch(doc.bedrooms[index].bedType){\n                case 'single':isSingle=true;break;\n                case 'double':isDouble=true;break;\n                case 'twin':isTwin=true;break;\n            }\n        }\n        var arr = [{label: \"Single\", value: \"single\",sel:isSingle?'selected':''},{label: \"Double\", value: \"double\",sel:isDouble?'selected':''},{label: \"Twin\", value: \"twin\",sel:isTwin?'selected':''}];\n        return arr;\n    },\n    hasAmenityCheckbox :function (v) {\n        var doc = Collections.Properties.findOne()\n        if(doc)\n        if(doc.amenities)\n        if(doc.amenities.length)\n        if(doc.amenities.indexOf(v)!=-1)return 'checked';\n        return '';\n    },\n    propertyContact :function (i) {\n        var doc = Collections.Properties.findOne()\n        if(doc)if(doc.contacts) if(doc.contacts.length) return doc.contacts[0];\n\n        return {\n            name:'',\n            phone:'',\n            email:'',\n        };\n    },\n    advertisementContact:function (i) {\n        var id = FlowRouter.current().params.id;\n        var doc = Collections.Properties.findOne(id,{\n            transform: function (data) {\n                if(data.auctionId)data.auction = Collections.Auctions.findOne(data.auctionId);\n                return data;\n            },\n            limit: 1\n        })\n        if(doc)if(doc.auction)if(doc.auction.contacts) if(doc.auction.contacts.length) return doc.auction.contacts[0];\n        return {\n            name:'',\n            phone:'',\n            email:'',\n        };\n    }\n})\nTemplate.editPropertyForm.events({\n    \"click .backBtn\": function(event, template){\n        goBack();\n    },\n    'submit form': function(event){\n        event.preventDefault();\n    },\n    \"click .editPropertyFormSaveActivateBtn\": function(event, template) {\n        $('#editPropertyFormCF').submit();\n    },\n    \"click .editPropertyFormCancelBtn\": function(event, template) {\n        goBack();\n    },\n    'change .selectPropertyImages': function(event, template) {return;\n        var files = event.target.files;\n        console.log('Upload called');\n        // console.log(files);\n        S3.upload({\n            files:files,\n            path:\"DEVpropertyImagesLarge\"\n        },function(e,r){\n            if(e){\n                throw new Meteor.Error('Upload failed ', e);\n                var tmp =  Session.get(\"showErrorDlg\");if(!tmp)tmp=[];\n                tmp.push(\"Upload failed: please check your internet connection, contact us if needed.\");\n                Session.set(\"showErrorDlg\",tmp)\n                return;\n            }\n            var editPropertyImages = Session.get('editPropertyImages');\n            var editPropertyImagesNewOnes = Session.get('editPropertyImagesNewOnes');\n            var tmp = {\n                name: r.file.original_name,\n                relative_url: r.relative_url,\n                url: r.secure_url\n            };\n            editPropertyImages.push(tmp);\n            editPropertyImagesNewOnes.push(tmp);\n            Session.set('editPropertyImages',editPropertyImages);\n            Session.set('editPropertyImagesNewOnes',editPropertyImagesNewOnes);\n            var propertyData = Session.get(\"propertyData\");\n\n            updateGalleriesInServer(editPropertyImages,propertyData._id, function (err, res) {\n                if (err) {\n                    console.log(err);\n                    var tmp =  Session.get(\"showErrorDlg\");if(!tmp)tmp=[];\n                    tmp.push(\"Upload failed: please check your internet connection, contact us if needed.\");\n                    Session.set(\"showErrorDlg\",tmp)\n                    return;\n                } else {\n                    var editPropertyImages = Session.get('editPropertyImages');\n                    console.log(\"Current Count: \"+editPropertyImages.length )\n                }\n            });\n            console.log(r);\n        });\n    },\n    'change .countySelected': function(event, template) {\n        template.countySelected.set(event.target.value);\n    },\n    \"click .openFileUploader\":function (event, template) {\n        event.preventDefault();\n        openPicker();\n        // filename\n        //     :\n        //     \"webcam-1/12/2018, 6:53:25 PM.png\"\n        // handle\n        //     :\n        //     \"G8lStVqHTiGnwxof6d5y\"\n        // mimetype\n        //     :\n        //     \"image/png\"\n        // originalFile\n        //     :\n        // {name: \"webcam-1/12/2018, 6:53:25 PM.png\", type: \"image/png\", size: 630585}\n        // originalPath\n        //     :\n        //     \"webcam-1/12/2018, 6:53:25 PM.png\"\n        // size\n        //     :\n        //     629612\n        // source\n        //     :\n        //     \"local_file_system\"\n        // status\n        //     :\n        //     \"Stored\"\n        // uploadId\n        //     :\n        //     \"ba2fe36e9fd182ec0cb88236d676cefad\"\n        // url\n        //     :\n        //     \"https://cdn.filestackcontent.com\n        return;\n    },\n    'keyup .autoGrowTA': function(event, template) {\n        var element = event.target;\n        element.style.height = \"5px\";\n        if(element.scrollHeight<310)element.style.height = (element.scrollHeight)+\"px\";\n        else element.style.height = \"310px\";\n    },\n    'change #numBedRoomCount': function(event, template) {\n        var numBedRoomCount = parseInt($(event.target).val());\n        if(isNaN(numBedRoomCount))return;\n        Template.instance().numBedRoomCount.set(numBedRoomCount);\n        t1 = template;\n        setTimeout(function () {\n            t1.$('#editPropertyFormCF').validate();\n        },500)\n    },\n})\nTemplate.editPropertyForm.onRendered(function () {\n    this.$('#readyFrom').datetimepicker();\n    var element = this.$('.autoGrowTA')[0];\n    if(element.scrollHeight<310)element.style.height = (element.scrollHeight)+\"px\";\n    else element.style.height = \"310px\";\n\n    // this.$('#editPropertyFormCF').validate();\n    editPropertyFormSaving = this.editPropertyFormSaving\n    var validator = this.$('#editPropertyFormCF').validate({\n        submitHandler: function(event){\n            editPropertyFormSaving.set(true);\n            console.log(\"You just submitted the 'editPropertyForm' form.\");\n            var doc = Collections.Properties.findOne()\n            if(doc){\n            Meteor.call('editProperty',doc._id,$('#editPropertyFormCF').serializeArray(),function (error, result) {\n                editPropertyFormSaving.set(false);\n                if(error){\n                    console.log(error)\n                    //    validator.showErrors({\n                    //         email: error.reason\n                    //     });\n                    var tmp =  Session.get(\"showErrorDlg\");if(!tmp)tmp=[];\n                    var msg = 'An error occurred.';\n                    if(error.reason)msg += ' '+error.reason+'.'\n                    else if(error.message)msg += ' '+error.message+'.'\n                    tmp.push(msg);\n                    Session.set(\"showErrorDlg\",tmp)\n                    return;\n                }\n                var propertyData = Session.get(\"propertyData\");\n                var editPropertyImages = Session.get('editPropertyImages');\n                if(!editPropertyImages){\n                    Session.set('editPropertyImages',[]);\n                    S3.collection.remove({})\n                    goBack();\n                }else{\n                updateGalleriesInServer(editPropertyImages, propertyData._id, function (err, res) {\n                    if (err) {\n                        console.log(err);\n                    } else {\n                        Session.set('editPropertyImages',[]);\n                        S3.collection.remove({})\n                    }\n                    goBack();\n                })\n                }\n                Session.set('hideAddPropertyForm',true)\n            })\n            }\n        }\n    });\n\n\n    if(Session.get('OpenImageUploader')){\n        scrollTo('.openFileUploader',0,500);\n        openPicker();\n        Session.set('OpenImageUploader',false)\n    }\n})\nTemplate.imageEditView.helpers({\n    images: function () {\n        // var propertyData = Session.get('propertyData');\n        // var existingGallery = propertyData.gallery;\n        // var editPropertyImages = Session.get('editPropertyImages');\n        // if(!editPropertyImages)editPropertyImages=[]\n        // if(!existingGallery )existingGallery =[]\n        // var newCombined = editPropertyImages.concat(existingGallery);\n        return Session.get('editPropertyImages');\n    }\n});\nTemplate.imgEditTag.events({\n    \"click .editImgBtn\": function (event, template) {\n        console.log(this);\n        debugger;\n\n        var editPropertyImages = Session.get('editPropertyImages');\n        var editPropertyImagesNewOnes = Session.get('editPropertyImagesNewOnes');\n        var isOriginalImageFromOwnS3 = false;\n\n        var newArr = [];\n        if(!editPropertyImages)return;\n        if(!editPropertyImages.length)return;\n\n        if(this.handle) {\n            index = getIndexByHandle(editPropertyImages, this.handle);\n        }else{\n            isOriginalImageFromOwnS3 = true;\n            index = getIndexByRelativeURL(editPropertyImages, this.relative_url);\n        }\n        newArr.push(editPropertyImages[index].url)//put it at first\n        // editPropertyImages.splice(index, 1);\n        //\n        // for(var i=0;i<editPropertyImages.length;i++){\n        //     newArr.push(editPropertyImages[i].url)\n        // }\n\n        const pickOptions = {\n            transformations:{\n                crop:{      force:true,\n                    aspectRatio:1.333},\n                rotate:true},\n            accept: 'image/*',\n            imageMax:[800,600]\n        };\n        fsClient.cropFiles(newArr,pickOptions).then( (response) => {\n            debugger;\n            var editPropertyImages = Session.get('editPropertyImages');\n            var editPropertyImagesNewOnes = Session.get('editPropertyImagesNewOnes');\n\n            //if its conversion from old amazon to new filestack, then it will create a new file, so delete the old file seperatly and insert a new file seperatly.\n\n            if(!response.filesUploaded.length){\n                var tmp =  Session.get(\"showErrorDlg\");if(!tmp)tmp=[];\n                tmp.push(\"Edit failed: please try again, contact us if needed.\");\n                Session.set(\"showErrorDlg\",tmp)\n                return;\n            }\n\n            if(isOriginalImageFromOwnS3){\n                S3.delete(editPropertyImages[index].relative_url,function(error, result){\n                    if(error){\n                        var tmp =  Session.get(\"showErrorDlg\");if(!tmp)tmp=[];\n                        tmp.push(\"Edit failed: please check your internet connection, contact us if needed.\");\n                        Session.set(\"showErrorDlg\",tmp)\n                        return;\n                    }\n\n                    var editPropertyImages = Session.get('editPropertyImages');\n                    editPropertyImages.splice(index, 1);\n                    Session.set('editPropertyImages',editPropertyImages);\n                    var propertyData = Session.get(\"propertyData\");\n                    updateGalleriesInServer(editPropertyImages,propertyData._id, function (err, res) {\n                        if (err) {\n                            console.log(err);\n                            var tmp =  Session.get(\"showErrorDlg\");if(!tmp)tmp=[];\n                            tmp.push(\"Edit failed: please check your internet connection, contact us if needed.\");\n                            Session.set(\"showErrorDlg\",tmp)\n                            return;\n                        } else {\n                            var editPropertyImages = Session.get('editPropertyImages');\n                            console.log(\"Current Count: \"+editPropertyImages.length )\n                        }\n                    });\n                })\n            }else{\n                fsClient.remove(editPropertyImages[index].handle).then(function(result){\n                    debugger;\n                    console.log('In fs remove result');\n                    var editPropertyImages = Session.get('editPropertyImages');\n                    editPropertyImages.splice(index, 1);\n                    Session.set('editPropertyImages',editPropertyImages);\n                    var propertyData = Session.get(\"propertyData\");\n                    updateGalleriesInServer(editPropertyImages,propertyData._id, function (err, res) {\n                        if (err) {\n                            console.log(err);\n                            var tmp =  Session.get(\"showErrorDlg\");if(!tmp)tmp=[];\n                            tmp.push(\"Edit failed: please check your internet connection, contact us if needed.\");\n                            Session.set(\"showErrorDlg\",tmp)\n                            return;\n                        } else {\n                            var editPropertyImages = Session.get('editPropertyImages');\n                            console.log(\"Current Count: \"+editPropertyImages.length )\n                        }\n                    });\n                });\n            }\n\n\n            var tmp = {};\n            for(var i =0;i<response.filesUploaded.length;i++){\n                tmp = {\n                    name: response.filesUploaded[i].filename,\n                    url: response.filesUploaded[i].url,\n                    handle: response.filesUploaded[i].handle,\n                    mimetype: response.filesUploaded[i].mimetype,\n                    originalFile: response.filesUploaded[i].originalFile,\n                    originalPath: response.filesUploaded[i].originalPath,\n                    size: response.filesUploaded[i].size,\n                    source: response.filesUploaded[i].source,\n                    status: response.filesUploaded[i].status,\n                    uploadId: response.filesUploaded[i].uploadId\n                }\n                // editPropertyImages.push(tmp);\n                editPropertyImages.splice(index+1, 0, tmp);//insert at the index place where its deleted.\n                editPropertyImagesNewOnes.push(tmp);\n            }\n\n            //Logic to insert new file.\n            Session.set('editPropertyImages',editPropertyImages);\n            var propertyData = Session.get(\"propertyData\");\n            updateGalleriesInServer(editPropertyImages,propertyData._id, function (err, res) {\n                if (err) {\n                    console.log(err);\n                    var tmp =  Session.get(\"showErrorDlg\");if(!tmp)tmp=[];\n                    tmp.push(\"Edit failed: please check your internet connection, contact us if needed.\");\n                    Session.set(\"showErrorDlg\",tmp)\n                    return;\n                } else {\n                    var editPropertyImages = Session.get('editPropertyImages');\n                    console.log(\"Current Count: \"+editPropertyImages.length )\n                }\n            });\n        });\n\n\n    },\n    \"click .deleteImgBtn\": function (event, template) {\n        console.log(this);\n        debugger;\n\n        var editPropertyImages = Session.get('editPropertyImages');\n        // editPropertyImages.splice(index, 1);\n        // Session.set('editPropertyImages',editPropertyImages);\n\n        if(this.handle){\n            index = getIndexByHandle(editPropertyImages, this.handle);\n\n            fsClient.remove(this.handle).then(function(result){\n                debugger;\n                console.log('In fs remove result');\n                var editPropertyImages = Session.get('editPropertyImages');\n                editPropertyImages.splice(index, 1);\n                Session.set('editPropertyImages',editPropertyImages);\n                var propertyData = Session.get(\"propertyData\");\n                updateGalleriesInServer(editPropertyImages,propertyData._id, function (err, res) {\n                    if (err) {\n                        console.log(err);\n                        var tmp =  Session.get(\"showErrorDlg\");if(!tmp)tmp=[];\n                        tmp.push(\"Deletion failed: please check your internet connection, contact us if needed.\");\n                        Session.set(\"showErrorDlg\",tmp)\n                        return;\n                    } else {\n                        var editPropertyImages = Session.get('editPropertyImages');\n                        console.log(\"Current Count: \"+editPropertyImages.length )\n                    }\n                });\n            });\n\n        }else{\n            index = getIndexByRelativeURL(editPropertyImages, this.relative_url);\n\n            S3.delete(this.relative_url,function(error, result){\n                if(error){\n                    var tmp =  Session.get(\"showErrorDlg\");if(!tmp)tmp=[];\n                    tmp.push(\"Deletion failed: please check your internet connection, contact us if needed.\");\n                    Session.set(\"showErrorDlg\",tmp)\n                    return;\n                }\n\n                var editPropertyImages = Session.get('editPropertyImages');\n                editPropertyImages.splice(index, 1);\n                Session.set('editPropertyImages',editPropertyImages);\n                var propertyData = Session.get(\"propertyData\");\n                updateGalleriesInServer(editPropertyImages,propertyData._id, function (err, res) {\n                    if (err) {\n                        console.log(err);\n                        var tmp =  Session.get(\"showErrorDlg\");if(!tmp)tmp=[];\n                        tmp.push(\"Deletion failed: please check your internet connection, contact us if needed.\");\n                        Session.set(\"showErrorDlg\",tmp)\n                        return;\n                    } else {\n                        var editPropertyImages = Session.get('editPropertyImages');\n                        console.log(\"Current Count: \"+editPropertyImages.length )\n                    }\n                });\n            })\n        }\n\n\n    }\n});\nfunction openPicker() {\n    fsClient.pick({\n        fromSources:[\"local_file_system\",\"webcam\",\"facebook\",\"url\",\"googledrive\",\"dropbox\",\"flickr\",\"instagram\",\"gmail\",\"picasa\",\"onedrive\",\"clouddrive\"],\n        maxFiles:10,\n        transformations:{\n            crop:{      force:true,\n                aspectRatio:1.333},\n            rotate:true},\n        imageMax:[800,600],\n        accept:[\"image/*\"]//,\".pdf\",\".doc\",\".docx\",\".docm\"\n    }).then(function(response) {\n        // declare this function to handle response\n        debugger;\n        var editPropertyImages = Session.get('editPropertyImages');\n        var editPropertyImagesNewOnes = Session.get('editPropertyImagesNewOnes');\n        var tmp = {};\n        if(response.filesUploaded)\n            for(var i =0;i<response.filesUploaded.length;i++){\n                tmp = {\n                    name: response.filesUploaded[i].filename,\n                    url: response.filesUploaded[i].url,\n                    handle: response.filesUploaded[i].handle,\n                    mimetype: response.filesUploaded[i].mimetype,\n                    originalFile: response.filesUploaded[i].originalFile,\n                    originalPath: response.filesUploaded[i].originalPath,\n                    size: response.filesUploaded[i].size,\n                    source: response.filesUploaded[i].source,\n                    status: response.filesUploaded[i].status,\n                    uploadId: response.filesUploaded[i].uploadId\n                }\n                editPropertyImages.push(tmp);\n                editPropertyImagesNewOnes.push(tmp);\n            }\n        Session.set('editPropertyImages',editPropertyImages);\n        Session.set('editPropertyImagesNewOnes',editPropertyImagesNewOnes);\n\n        var propertyData = Session.get(\"propertyData\");\n        updateGalleriesInServer(editPropertyImages,propertyData._id, function (err, res) {\n            if (err) {\n                console.log(err);\n                var tmp =  Session.get(\"showErrorDlg\");if(!tmp)tmp=[];\n                tmp.push(\"Upload failed: please check your internet connection, contact us if needed.\");\n                Session.set(\"showErrorDlg\",tmp)\n                return;\n            } else {\n                var editPropertyImages = Session.get('editPropertyImages');\n                console.log(\"Current Count: \"+editPropertyImages.length )\n                if(Session.get('fromAdvertiseWithUsPage')){\n                    fbq('track', 'CompleteRegistration');\n                    ga('send', 'event', 'AdvertiseWithUsPage', 'ImageUploaded', 'Property Images Uploaded.')\n                    Session.set('fromAdvertiseWithUsPage',false)\n                }\n            }\n        });\n        console.log(response);\n    });\n}\n\nfunction goBack(){\n    var prevRoute = Session.get('prevRoute');\n    if(prevRoute){\n        FlowRouter.go(prevRoute.name,prevRoute.args)\n        Session.set('prevRoute',false);\n        if(prevRoute.scrollTo){\n            scrollTo(prevRoute.scrollTo,0,500)\n        }\n    }else{\n        FlowRouter.go(\"/account/myproperies/\",{pageno:1});\n    }\n}\nfunction getpropertyData(){\n    var id = FlowRouter.current().params.id;\n\n    var ret = Collections.Properties.find(id, {\n        transform: function(data){\n\n            data.auction = Collections.Auctions.findOne(data.auctionId);\n            data.applicationsReceivedCount = Collections.Bids.find({auctionId:data.auctionId}).count();\n            data.applicationsActiveCount = Collections.Bids.find({auctionId:data.auctionId,isArchived:false}).count();\n\n            return data;\n        },\n        limit: 1\n    }).fetch();\n    // console.log(\"getProjectData\");\n    return ret[0];\n}\nfunction getIndexByHandle(myArray, fileId){\n    for (var i=0; i < myArray.length; i++) {\n        if (myArray[i].handle === fileId) {\n            return i;\n        }\n    }\n}\nfunction getIndexByRelativeURL(myArray, fileId){\n    for (var i=0; i < myArray.length; i++) {\n        if (myArray[i].relative_url === fileId) {\n            return i;\n        }\n    }\n}\n\nfunction attachEvents() {\n    $(\".deactivateConfirmBtn\").unbind().bind(\"click\",function () {\n        deactivateConfEvent();\n    })\n    $(\".archiveConfirmBtn\").unbind().bind(\"click\",function () {\n        archiveConfEvent();\n    })\n    $(\".closePopupBtn\").unbind().bind(\"click\",function () {\n        closePopupEvent();\n    })\n}\nfunction deactivateConfEvent() {\n    var data = Session.get(\"propertyData\");\n    var auctionId = data.auctionId;\n\n    deactivateInProgress.set(true) ;\n    Meteor.call('deactivateAuction',auctionId,function(error, result){\n        deactivateInProgress.set(false) ;\n        if(error){\n            console.log(error);\n            var tmp =  Session.get(\"showErrorDlg\");if(!tmp)tmp=[];\n            tmp.push(\"Failed deactivating. Please try again, try checking your internet connectivity. Contact us if needed.\");\n            Session.set(\"showErrorDlg\",tmp)\n            return;\n        }\n        console.log(\"Success\");\n        var prevRoute = Session.get('prevRoute');\n        closePopupEvent();\n        goBack();\n\n    });\n}\nfunction archiveConfEvent() {\n    var data = Session.get(\"propertyData\");\n    var propertyId = data._id;\n\n    archiveInProgress.set(true) ;\n    Meteor.call('archiveProperty',propertyId,function(error, result){\n        archiveInProgress.set(false) ;\n        if(error){\n            console.log(error);\n            var tmp =  Session.get(\"showErrorDlg\");if(!tmp)tmp=[];\n            tmp.push(\"Failed archiving. Please try again, try checking your internet connectivity. Contact us if needed.\");\n            Session.set(\"showErrorDlg\",tmp)\n            return;\n        }\n        console.log(\"Success\");\n        var prevRoute = Session.get('prevRoute');\n        closePopupEvent();\n        goBack();\n\n    });\n}\nfunction closePopupEvent() {\n    console.log('closePopupEvent');\n    if($)\n        if($.fancybox)\n            $.fancybox.close();\n}\n\n\nfunction titleCase(str){\n    if(!str)return;\n    return str.charAt(0).toUpperCase() + str.toLowerCase().substring(1);\n}\nfunction slugifyEmailAddress (text) {\n    if(!text)return '';\n    const a = 'àáäâèéëêìíïîòóöôùúüûñçßÿœæŕśńṕẃǵǹḿǘẍźḧ/_,:;'\n    const b = 'aaaaeeeeiiiioooouuuuncsyoarsnpwgnmuxzh------'\n    const p = new RegExp(a.split('').join('|'), 'g')\n\n    return text.toString().toLowerCase()\n        .replace(/\\s+/g, '.')           // Replace spaces with \".\"\n        .replace(p, c =>\n            b.charAt(a.indexOf(c)))     // Replace special chars\n        .replace(/&/g, '-and-')         // Replace & with ''\n        // .replace(/[^\\w\\-]+/g, '')       // Remove all non-word chars\n        .replace(/\\-\\-+/g, '-')         // Replace multiple - with single ''\n        .replace(/^-+/, '')             // Trim - from start of text\n        .replace(/-+$/, '')             // Trim - from end of text\n}"]},"sourceType":"module","hash":"deb7960db917b26693daa01901aeb0dd6b5a87fb"}
