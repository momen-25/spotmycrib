{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/home/momen/projects/spotmycrib-master/packages/staringatlights:inject-data/lib/server.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","objectRestSpread","objectRestSpread","asyncGenerators","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"os.linux.x86_64"},"sourceFileName":"packages/staringatlights:inject-data/lib/server.js","filename":"/home/momen/projects/spotmycrib-master/packages/staringatlights:inject-data/lib/server.js","targets":{},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/home/momen/projects/spotmycrib-master","root":"/home/momen/projects/spotmycrib-master","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.13.10","helpers":true,"useESModules":false,"corejs":false}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-meteor-async-await","visitor":{"AwaitExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]},"ClassPrivateMethod":{"exit":[null]}},"options":{"useNativeAsyncAwait":false}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":{},"_verified":{},"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}}],"presets":[],"generatorOpts":{"filename":"/home/momen/projects/spotmycrib-master/packages/staringatlights:inject-data/lib/server.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"packages/staringatlights:inject-data/lib/server.js"}},"code":"let InjectData;\nmodule.link(\"./namespace\", {\n  InjectData(v) {\n    InjectData = v;\n  }\n\n}, 0);\nlet WebAppInternals;\nmodule.link(\"meteor/webapp\", {\n  WebAppInternals(v) {\n    WebAppInternals = v;\n  }\n\n}, 1);\n// Supports legacy uses of inject data, SSR users should turn this to false\nInjectData.injectToHead = true;\nWebAppInternals.registerBoilerplateDataCallback('inject-data', (req, data, arch) => {\n  if (req && req.headers && req.headers._injectPayload && !InjectData.disableInjection) {\n    const payload = \"<script type=\\\"text/inject-data\\\">\".concat(InjectData.encode(req.headers._injectPayload), \"</script>\");\n\n    if (InjectData.injectToHead) {\n      if (!data.dynamicHead) {\n        data.dynamicHead = '';\n      }\n\n      data.dynamicHead += payload;\n    } else {\n      if (!data.dynamicBody) {\n        data.dynamicBody = '';\n      }\n\n      data.dynamicBody += payload;\n    }\n  }\n\n  return false;\n});\n/**\n * Pushes data into the InjectData payload.\n * @param {object} node request object\n * @param {string} key\n * @param {*} value\n */\n\nInjectData.pushData = function pushData(req, key, value) {\n  if (!req.headers) {\n    req.headers = {};\n  }\n\n  if (!req.headers._injectPayload) {\n    req.headers._injectPayload = {};\n  }\n\n  req.headers._injectPayload[key] = value;\n};\n/**\n * Returns the object associated with the specified key.\n * @param {string} key\n */\n\n\nInjectData.getData = function getData(req, key) {\n  if (req.headers && req.headers._injectPayload) {\n    return Object.assign({}, req.headers._injectPayload[key]);\n  } else {\n    return null;\n  }\n};","map":{"version":3,"sources":["packages/staringatlights:inject-data/lib/server.js"],"names":["InjectData","module","link","v","WebAppInternals","injectToHead","registerBoilerplateDataCallback","req","data","arch","headers","_injectPayload","disableInjection","payload","encode","dynamicHead","dynamicBody","pushData","key","value","getData","Object","assign"],"mappings":"AAAA,IAAIA,UAAJ;AAAeC,MAAM,CAACC,IAAP,CAAY,aAAZ,EAA0B;AAACF,EAAAA,UAAU,CAACG,CAAD,EAAG;AAACH,IAAAA,UAAU,GAACG,CAAX;AAAa;;AAA5B,CAA1B,EAAwD,CAAxD;AAA2D,IAAIC,eAAJ;AAAoBH,MAAM,CAACC,IAAP,CAAY,eAAZ,EAA4B;AAACE,EAAAA,eAAe,CAACD,CAAD,EAAG;AAACC,IAAAA,eAAe,GAACD,CAAhB;AAAkB;;AAAtC,CAA5B,EAAoE,CAApE;AAI9F;AACAH,UAAU,CAACK,YAAX,GAA0B,IAA1B;AAEAD,eAAe,CAACE,+BAAhB,CACC,aADD,EAEC,CAACC,GAAD,EAAMC,IAAN,EAAYC,IAAZ,KAAqB;AACpB,MACCF,GAAG,IACHA,GAAG,CAACG,OADJ,IAEAH,GAAG,CAACG,OAAJ,CAAYC,cAFZ,IAGA,CAACX,UAAU,CAACY,gBAJb,EAKE;AACD,UAAMC,OAAO,+CAAsCb,UAAU,CAACc,MAAX,CAClDP,GAAG,CAACG,OAAJ,CAAYC,cADsC,CAAtC,cAAb;;AAIA,QAAIX,UAAU,CAACK,YAAf,EAA6B;AAC5B,UAAI,CAACG,IAAI,CAACO,WAAV,EAAuB;AACtBP,QAAAA,IAAI,CAACO,WAAL,GAAmB,EAAnB;AACA;;AACDP,MAAAA,IAAI,CAACO,WAAL,IAAoBF,OAApB;AACA,KALD,MAKO;AACN,UAAI,CAACL,IAAI,CAACQ,WAAV,EAAuB;AACtBR,QAAAA,IAAI,CAACQ,WAAL,GAAmB,EAAnB;AACA;;AACDR,MAAAA,IAAI,CAACQ,WAAL,IAAoBH,OAApB;AACA;AACD;;AACD,SAAO,KAAP;AACA,CA1BF;AA6BA;AACA;AACA;AACA;AACA;AACA;;AACAb,UAAU,CAACiB,QAAX,GAAsB,SAASA,QAAT,CAAkBV,GAAlB,EAAuBW,GAAvB,EAA4BC,KAA5B,EAAmC;AACxD,MAAI,CAACZ,GAAG,CAACG,OAAT,EAAkB;AACjBH,IAAAA,GAAG,CAACG,OAAJ,GAAc,EAAd;AACA;;AACD,MAAI,CAACH,GAAG,CAACG,OAAJ,CAAYC,cAAjB,EAAiC;AAChCJ,IAAAA,GAAG,CAACG,OAAJ,CAAYC,cAAZ,GAA6B,EAA7B;AACA;;AAEDJ,EAAAA,GAAG,CAACG,OAAJ,CAAYC,cAAZ,CAA2BO,GAA3B,IAAkCC,KAAlC;AACA,CATD;AAWA;AACA;AACA;AACA;;;AACAnB,UAAU,CAACoB,OAAX,GAAqB,SAASA,OAAT,CAAiBb,GAAjB,EAAsBW,GAAtB,EAA2B;AAC/C,MAAIX,GAAG,CAACG,OAAJ,IAAeH,GAAG,CAACG,OAAJ,CAAYC,cAA/B,EAA+C;AAC9C,WAAOU,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBf,GAAG,CAACG,OAAJ,CAAYC,cAAZ,CAA2BO,GAA3B,CAAlB,CAAP;AACA,GAFD,MAEO;AACN,WAAO,IAAP;AACA;AACD,CAND","sourcesContent":["\nimport { InjectData } from './namespace'\nimport { WebAppInternals } from 'meteor/webapp'\n\n// Supports legacy uses of inject data, SSR users should turn this to false\nInjectData.injectToHead = true\n\nWebAppInternals.registerBoilerplateDataCallback(\n\t'inject-data',\n\t(req, data, arch) => {\n\t\tif (\n\t\t\treq &&\n\t\t\treq.headers &&\n\t\t\treq.headers._injectPayload &&\n\t\t\t!InjectData.disableInjection\n\t\t) {\n\t\t\tconst payload = `<script type=\"text/inject-data\">${InjectData.encode(\n\t\t\t\treq.headers._injectPayload\n\t\t\t)}</script>`\n\n\t\t\tif (InjectData.injectToHead) {\n\t\t\t\tif (!data.dynamicHead) {\n\t\t\t\t\tdata.dynamicHead = ''\n\t\t\t\t}\n\t\t\t\tdata.dynamicHead += payload\n\t\t\t} else {\n\t\t\t\tif (!data.dynamicBody) {\n\t\t\t\t\tdata.dynamicBody = ''\n\t\t\t\t}\n\t\t\t\tdata.dynamicBody += payload\n\t\t\t}\n\t\t}\n\t\treturn false\n\t}\n)\n\n/**\n * Pushes data into the InjectData payload.\n * @param {object} node request object\n * @param {string} key\n * @param {*} value\n */\nInjectData.pushData = function pushData(req, key, value) {\n\tif (!req.headers) {\n\t\treq.headers = {}\n\t}\n\tif (!req.headers._injectPayload) {\n\t\treq.headers._injectPayload = {}\n\t}\n\n\treq.headers._injectPayload[key] = value\n}\n\n/**\n * Returns the object associated with the specified key.\n * @param {string} key\n */\nInjectData.getData = function getData(req, key) {\n\tif (req.headers && req.headers._injectPayload) {\n\t\treturn Object.assign({}, req.headers._injectPayload[key]);\n\t} else {\n\t\treturn null\n\t}\n}\n"]},"sourceType":"module","hash":"23ef4bf43312cebc98c24b5f4342fc4e82ec94dc"}
