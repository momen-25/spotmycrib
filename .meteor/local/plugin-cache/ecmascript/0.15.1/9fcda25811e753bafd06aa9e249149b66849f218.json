{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/home/momen/projects/spotmycrib-master/packages/mdg:meteor-apm-agent/lib/hijack/error.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","objectRestSpread","objectRestSpread","asyncGenerators","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"os.linux.x86_64"},"sourceFileName":"packages/mdg:meteor-apm-agent/lib/hijack/error.js","filename":"/home/momen/projects/spotmycrib-master/packages/mdg:meteor-apm-agent/lib/hijack/error.js","targets":{},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/home/momen/projects/spotmycrib-master","root":"/home/momen/projects/spotmycrib-master","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.13.10","helpers":true,"useESModules":false,"corejs":false}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-meteor-async-await","visitor":{"AwaitExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]},"ClassPrivateMethod":{"exit":[null]}},"options":{"useNativeAsyncAwait":false}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":{},"_verified":{},"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}}],"presets":[],"generatorOpts":{"filename":"/home/momen/projects/spotmycrib-master/packages/mdg:meteor-apm-agent/lib/hijack/error.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"packages/mdg:meteor-apm-agent/lib/hijack/error.js"}},"code":"TrackUncaughtExceptions = function () {\n  process.on('uncaughtException', function (err) {\n    // skip errors with `_skipKadira` flag\n    if (err._skipKadira) {\n      return;\n    } // let the server crash normally if error tracking is disabled\n\n\n    if (!Kadira.options.enableErrorTracking) {\n      printErrorAndKill(err);\n    } // looking for already tracked errors and throw them immediately\n    // throw error immediately if kadira is not ready\n\n\n    if (err._tracked || !Kadira.connected) {\n      printErrorAndKill(err);\n    }\n\n    var trace = getTrace(err, 'server-crash', 'uncaughtException');\n    Kadira.models.error.trackError(err, trace);\n\n    Kadira._sendPayload(function () {\n      clearTimeout(timer);\n      throwError(err);\n    });\n\n    var timer = setTimeout(function () {\n      throwError(err);\n    }, 1000 * 10);\n\n    function throwError(err) {\n      // sometimes error came back from a fiber.\n      // But we don't fibers to track that error for us\n      // That's why we throw the error on the nextTick\n      process.nextTick(function () {\n        // we need to mark this error where we really need to throw\n        err._tracked = true;\n        printErrorAndKill(err);\n      });\n    }\n  });\n\n  function printErrorAndKill(err) {\n    // since we are capturing error, we are also on the error message.\n    // so developers think we are also reponsible for the error.\n    // But we are not. This will fix that.\n    console.error(err.stack);\n    process.exit(7);\n  }\n};\n\nTrackMeteorDebug = function () {\n  var originalMeteorDebug = Meteor._debug;\n\n  Meteor._debug = function (message, stack) {\n    if (!Kadira.options.enableErrorTracking) {\n      return originalMeteorDebug.call(this, message, stack);\n    } // We've changed `stack` into an object at method and sub handlers so we can\n    // ignore them here. These errors are already tracked so don't track again.\n\n\n    if (stack && stack.stack) {\n      stack = stack.stack; // Restore so origionalMeteorDebug shows the stack as a string instead as\n      // an object\n\n      arguments[1] = stack;\n    } else {\n      // only send to the server, if only connected to kadira\n      if (Kadira.connected) {\n        var error = new Error(message);\n        error.stack = stack;\n        var trace = getTrace(error, 'server-internal', 'Meteor._debug');\n        Kadira.models.error.trackError(error, trace);\n      }\n    }\n\n    return originalMeteorDebug.apply(this, arguments);\n  };\n};\n\nfunction getTrace(err, type, subType) {\n  return {\n    type: type,\n    subType: subType,\n    name: err.message,\n    errored: true,\n    at: Kadira.syncedDate.getTime(),\n    events: [['start', 0, {}], ['error', 0, {\n      error: {\n        message: err.message,\n        stack: err.stack\n      }\n    }]],\n    metrics: {\n      total: 0\n    }\n  };\n}","map":{"version":3,"sources":["packages/mdg:meteor-apm-agent/lib/hijack/error.js"],"names":["TrackUncaughtExceptions","process","on","err","_skipKadira","Kadira","options","enableErrorTracking","printErrorAndKill","_tracked","connected","trace","getTrace","models","error","trackError","_sendPayload","clearTimeout","timer","throwError","setTimeout","nextTick","console","stack","exit","TrackMeteorDebug","originalMeteorDebug","Meteor","_debug","message","call","arguments","Error","apply","type","subType","name","errored","at","syncedDate","getTime","events","metrics","total"],"mappings":"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","sourcesContent":["TrackUncaughtExceptions = function () {\n  process.on('uncaughtException', function (err) {\n    // skip errors with `_skipKadira` flag\n    if(err._skipKadira) {\n      return;\n    }\n\n    // let the server crash normally if error tracking is disabled\n    if(!Kadira.options.enableErrorTracking) {\n      printErrorAndKill(err);\n    }\n\n    // looking for already tracked errors and throw them immediately\n    // throw error immediately if kadira is not ready\n    if(err._tracked || !Kadira.connected) {\n      printErrorAndKill(err);\n    }\n\n    var trace = getTrace(err, 'server-crash', 'uncaughtException');\n    Kadira.models.error.trackError(err, trace);\n    Kadira._sendPayload(function () {\n      clearTimeout(timer);\n      throwError(err);\n    });\n\n    var timer = setTimeout(function () {\n      throwError(err);\n    }, 1000*10);\n\n    function throwError(err) {\n      // sometimes error came back from a fiber.\n      // But we don't fibers to track that error for us\n      // That's why we throw the error on the nextTick\n      process.nextTick(function() {\n        // we need to mark this error where we really need to throw\n        err._tracked = true;\n        printErrorAndKill(err);\n      });\n    }\n  });\n\n  function printErrorAndKill(err) {\n    // since we are capturing error, we are also on the error message.\n    // so developers think we are also reponsible for the error.\n    // But we are not. This will fix that.\n    console.error(err.stack);\n    process.exit(7);\n  }\n}\n\nTrackMeteorDebug = function () {\n  var originalMeteorDebug = Meteor._debug;\n  Meteor._debug = function (message, stack) {\n    if(!Kadira.options.enableErrorTracking) {\n      return originalMeteorDebug.call(this, message, stack);\n    }\n\n    // We've changed `stack` into an object at method and sub handlers so we can\n    // ignore them here. These errors are already tracked so don't track again.\n    if(stack && stack.stack) {\n      stack = stack.stack;\n      // Restore so origionalMeteorDebug shows the stack as a string instead as\n      // an object\n      arguments[1] = stack;\n    } else {\n      // only send to the server, if only connected to kadira\n      if(Kadira.connected) {\n        var error = new Error(message);\n        error.stack = stack;\n        var trace = getTrace(error, 'server-internal', 'Meteor._debug');\n        Kadira.models.error.trackError(error, trace);\n      }\n    }\n\n    return originalMeteorDebug.apply(this, arguments);\n  }\n}\n\nfunction getTrace(err, type, subType) {\n  return {\n    type: type,\n    subType: subType,\n    name: err.message,\n    errored: true,\n    at: Kadira.syncedDate.getTime(),\n    events: [\n      ['start', 0, {}],\n      ['error', 0, {error: {message: err.message, stack: err.stack}}]\n    ],\n    metrics: {\n      total: 0\n    }\n  };\n}\n"]},"sourceType":"module","hash":"9fcda25811e753bafd06aa9e249149b66849f218"}
