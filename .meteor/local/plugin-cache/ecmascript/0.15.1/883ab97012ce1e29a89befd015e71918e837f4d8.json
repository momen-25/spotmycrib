{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/home/momen/projects/spotmycrib-master/imports/ui/templates/tenants.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","objectRestSpread","objectRestSpread","asyncGenerators","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"os.linux.x86_64"},"sourceFileName":"imports/ui/templates/tenants.js","filename":"/home/momen/projects/spotmycrib-master/imports/ui/templates/tenants.js","targets":{},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/home/momen/projects/spotmycrib-master","root":"/home/momen/projects/spotmycrib-master","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.13.10","helpers":true,"useESModules":false,"corejs":false}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-meteor-async-await","visitor":{"AwaitExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]},"ClassPrivateMethod":{"exit":[null]}},"options":{"useNativeAsyncAwait":false}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":{},"_verified":{},"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}}],"presets":[],"generatorOpts":{"filename":"/home/momen/projects/spotmycrib-master/imports/ui/templates/tenants.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"imports/ui/templates/tenants.js"}},"code":"module.link(\"./pagination.html\");\nmodule.link(\"./tenants.html\");\nTemplate.tenants.onCreated(function () {\n  var instance = this;\n  instance.isSubsLoaded = new ReactiveVar(false);\n  instance.autorun(function () {\n    instance.subscribe('userData');\n    var pageno = FlowRouter.getParam('pageno');\n    if (!pageno) pageno = 1;\n    instance.subscribe(\"tenants\", pageno);\n\n    if (instance.subscriptionsReady()) {\n      instance.isSubsLoaded.set(true);\n    }\n  });\n});\nTemplate.tenants.helpers({\n  isSubsLoaded: function () {\n    return Template.instance().subscriptionsReady();\n  },\n  userLoggedIn: function () {\n    if (Meteor.user()) return true;\n    return false;\n  },\n  dataFull: function () {\n    var pageno = FlowRouter.getParam('pageno');\n    if (!pageno) pageno = 1;\n    var totalResultsCount = Meteor.users.find().count(); /////PAGINATION\n\n    var resultsPerPage = 10;\n    var currentPageNo = FlowRouter.getParam('pageno');\n\n    if (!currentPageNo) {\n      currentPageNo = 1;\n    }\n\n    var urlBase = 'tenants/';\n    return {\n      totalResultsCount: totalResultsCount,\n      results: Meteor.users.find(),\n      pagination: getPaginationData(totalResultsCount, currentPageNo, urlBase, resultsPerPage)\n    };\n  }\n});\nTemplate.tenantList.helpers({\n  userFirstName: function () {\n    try {\n      var tmp = this.user.profile.name.split(' ');\n      return tmp[0];\n    } catch (e) {}\n  }\n});\nTemplate.tenantList.events({\n  'click .inviteToApply': function (event, template) {\n    ga('send', 'event', 'tenantsPage', 'inviteToApplyBtnClicked', 'Invite To Apply Btn Clicked');\n    var user = Meteor.user();\n\n    if (!user) {\n      //Login is needed.\n      Session.set('showForgotForm', false);\n      Session.set('showSignupForm', false);\n      Session.set('showLoginSignupFancyBoxDialog', true);\n      Session.set('showLoginDialog', true);\n      return;\n    }\n\n    Session.set('inviteToApplyData', {\n      user: this.user\n    });\n    $.fancybox({\n      'padding': 0,\n      'href': '#inviteToApplyDlg' // afterShow:function () {}\n\n    });\n  }\n});\ninviteInProgress = '';\nTemplate.inviteToApply.onCreated(function () {\n  this.inviteInProgress = new ReactiveVar(false);\n  inviteInProgress = this.inviteInProgress;\n  Meteor.subscribe('inviteToApply.MyActiveAdvertisements');\n});\nTemplate.inviteToApply.helpers({\n  data: function () {\n    return Session.get('inviteToApplyData');\n  },\n  myAdvertisements: function () {\n    var select = {\n      \"isArchived\": false,\n      \"createdByAgent\": Meteor.userId()\n    };\n    var totalResultsCount = Collections.Auctions.find(select).count();\n    return {\n      totalResultsCount: totalResultsCount,\n      results: Collections.Auctions.find(select)\n    };\n  },\n  userFirstName: function () {\n    var data = Session.get('inviteToApplyData');\n\n    try {\n      var tmp = data.user.profile.name.split(' ');\n      return tmp[0];\n    } catch (e) {}\n  },\n  inviteInProgress: function () {\n    // console.log('h 1 ')\n    // console.log(Template.instance().inviteInProgress.get())\n    inviteInProgress = Template.instance().inviteInProgress;\n    return Template.instance().inviteInProgress.get();\n  }\n});\nTemplate.inviteToApply.events({\n  'click .advertiseMyProperty': function () {\n    closePopupEvent();\n    FlowRouter.go('account/myProperties');\n  },\n  'click .confirmInviteBtn': function () {\n    var selectedAdvertisements = [];\n    $.each($(\".selectedAdvertisements option:selected\"), function () {\n      selectedAdvertisements.push($(this).val());\n    });\n\n    if (!selectedAdvertisements.length) {\n      alert('Please choose at least 1 advertisement to proceed');\n      return;\n    }\n\n    var data = Session.get('inviteToApplyData');\n    inviteInProgress.set(true);\n    Meteor.call('sendInviteToApplyEmail', [selectedAdvertisements, data.user._id], function (error, result) {\n      inviteInProgress.set(false);\n\n      if (error) {\n        console.log(error);\n        var tmp = Session.get(\"showErrorDlg\");\n        if (!tmp) tmp = [];\n        tmp.push(\"Failed applying. Please try again, try checking your internet connectivity. Contact us if needed.\");\n        Session.set(\"showErrorDlg\", tmp);\n        return;\n      }\n\n      if (result.status == 'Success') {\n        console.log(\"Success\");\n        closePopupEvent();\n      }\n    });\n  },\n  'click .closePopupBtn': function () {\n    closePopupEvent();\n  }\n});\n\nfunction titleCase(str) {\n  if (!str) return;\n  return str.charAt(0).toUpperCase() + str.toLowerCase().substring(1);\n}\n\nfunction getPaginationData(totalResultsCount, currentPageNo, urlBase, resultsPerPage) {\n  var pages = [],\n      prevPage = {},\n      nextPage = {};\n  var pgMin = currentPageNo - 4,\n      pgMax = currentPageNo + 5,\n      maxPages = Math.ceil(totalResultsCount / resultsPerPage);\n  if (pgMin < 1) pgMin = 1;\n  if (pgMax < 1) pgMax = 1;\n  if (maxPages < 1) maxPages = 1;\n  if (pgMin > maxPages) currentPageNo = maxPages;\n  var tmp = {};\n\n  for (var i = pgMin; i <= maxPages; i++) {\n    var href = urlBase + i + \"/\";\n    tmp = {\n      \"href\": href,\n      \"text\": i\n    };\n\n    if (i == currentPageNo) {\n      tmp['href'] = 'javascript:void(0);';\n      tmp['current'] = true;\n    }\n\n    pages.push(tmp);\n  } // if(pgMin==maxPages){//Above loop won't work if only 1 page result\n  //     pages.push({\n  //         \"href\": 'javascript:void(0);',\n  //         \"text\": 1\n  //     })\n  // }\n\n\n  var prevPageNo = currentPageNo - 1,\n      nextPageNo = currentPageNo + 1;\n\n  if (prevPageNo < 1) {\n    prevPage['href'] = 'javascript:void(0)';\n    prevPage['text'] = 'Previous';\n    prevPage['disabled'] = 'disabled';\n  } else {\n    prevPage['href'] = urlBase + prevPageNo + \"/\";\n    prevPage['text'] = 'Previous';\n  }\n\n  if (nextPageNo > maxPages) nextPageNo = maxPages;\n\n  if (nextPageNo == currentPageNo) {\n    nextPage['href'] = 'javascript:void(0)';\n    nextPage['text'] = 'Next';\n    nextPage['disabled'] = 'disabled';\n  } else {\n    nextPage['href'] = urlBase + nextPageNo + \"/\";\n    nextPage['text'] = 'Next';\n  }\n\n  return {\n    \"prevPage\": prevPage,\n    \"pages\": pages,\n    \"nextPage\": nextPage\n  };\n}\n\nfunction closePopupEvent() {\n  console.log('closePopupEvent');\n  if ($) if ($.fancybox) $.fancybox.close();\n}","map":{"version":3,"sources":["imports/ui/templates/tenants.js"],"names":["module","link","Template","tenants","onCreated","instance","isSubsLoaded","ReactiveVar","autorun","subscribe","pageno","FlowRouter","getParam","subscriptionsReady","set","helpers","userLoggedIn","Meteor","user","dataFull","totalResultsCount","users","find","count","resultsPerPage","currentPageNo","urlBase","results","pagination","getPaginationData","tenantList","userFirstName","tmp","profile","name","split","e","events","event","template","ga","Session","$","fancybox","inviteInProgress","inviteToApply","data","get","myAdvertisements","select","userId","Collections","Auctions","closePopupEvent","go","selectedAdvertisements","each","push","val","length","alert","call","_id","error","result","console","log","status","titleCase","str","charAt","toUpperCase","toLowerCase","substring","pages","prevPage","nextPage","pgMin","pgMax","maxPages","Math","ceil","i","href","prevPageNo","nextPageNo","close"],"mappings":"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","sourcesContent":["import \"./pagination.html\";\nimport \"./tenants.html\";\n\nTemplate.tenants.onCreated(function(){\n\n    var instance = this;\n    instance.isSubsLoaded = new ReactiveVar(false);\n    instance.autorun(function(){\n\n        instance.subscribe('userData');\n        var pageno = FlowRouter.getParam('pageno'); if(!pageno)pageno=1;\n        instance.subscribe(\"tenants\",pageno) ;\n\n        if(instance.subscriptionsReady()){\n            instance.isSubsLoaded.set(true)\n        }\n    })\n\n})\nTemplate.tenants.helpers({\n    isSubsLoaded:function(){\n        return Template.instance().subscriptionsReady();\n    },\n    userLoggedIn:function(){\n        if(Meteor.user())return true;\n        return false;\n    },\n    dataFull:function(){\n        var pageno = FlowRouter.getParam('pageno'); if(!pageno)pageno=1;\n        var totalResultsCount = Meteor.users.find().count();\n\n        /////PAGINATION\n        var resultsPerPage = 10;\n        var currentPageNo = FlowRouter.getParam('pageno');\n        if(!currentPageNo){currentPageNo = 1}\n        var urlBase = 'tenants/';\n\n        return {\n            totalResultsCount:totalResultsCount,\n            results: Meteor.users.find(),\n            pagination: getPaginationData(totalResultsCount,currentPageNo,urlBase,resultsPerPage)\n        }\n    }\n})\nTemplate.tenantList.helpers({\n    userFirstName:function(){\n        try{\n            var tmp = this.user.profile.name.split(' ');\n            return tmp[0];\n        }catch(e){}\n    }\n})\nTemplate.tenantList.events({\n    'click .inviteToApply':function(event, template){\n        ga('send', 'event', 'tenantsPage', 'inviteToApplyBtnClicked', 'Invite To Apply Btn Clicked');\n        var user = Meteor.user();\n        if(!user){//Login is needed.\n            Session.set('showForgotForm',false)\n            Session.set('showSignupForm',false)\n            Session.set('showLoginSignupFancyBoxDialog',true)\n            Session.set('showLoginDialog',true)\n            return ;\n        }\n        Session.set('inviteToApplyData',{user:this.user})\n        $.fancybox({\n            'padding': 0,\n            'href': '#inviteToApplyDlg',\n            // afterShow:function () {}\n        });\n    }\n})\ninviteInProgress='';\nTemplate.inviteToApply.onCreated(function () {\n    this.inviteInProgress = new ReactiveVar( false );\n    inviteInProgress = this.inviteInProgress;\n    Meteor.subscribe('inviteToApply.MyActiveAdvertisements')\n})\nTemplate.inviteToApply.helpers({\n    data:function(){\n      return Session.get('inviteToApplyData');\n    },\n    myAdvertisements:function(){\n        var select = {\n            \"isArchived\":false,\n            \"createdByAgent\":Meteor.userId()\n        };\n        var totalResultsCount = Collections.Auctions.find(select).count();\n        return {\n            totalResultsCount:totalResultsCount,\n            results: Collections.Auctions.find(select)\n        }\n    },\n    userFirstName:function(){\n        var data = Session.get('inviteToApplyData');\n        try{\n            var tmp = data.user.profile.name.split(' ');\n            return tmp[0];\n        }catch(e){}\n    },\n    inviteInProgress:function () {\n        // console.log('h 1 ')\n        // console.log(Template.instance().inviteInProgress.get())\n        inviteInProgress = Template.instance().inviteInProgress ;\n        return Template.instance().inviteInProgress.get() ;\n    },\n})\nTemplate.inviteToApply.events({\n    'click .advertiseMyProperty':function(){\n        closePopupEvent();\n        FlowRouter.go('account/myProperties');\n    },\n    'click .confirmInviteBtn':function () {\n        var selectedAdvertisements = [];\n        $.each($(\".selectedAdvertisements option:selected\"), function(){\n            selectedAdvertisements.push($(this).val());\n        });\n        if(!selectedAdvertisements.length){\n            alert('Please choose at least 1 advertisement to proceed');return;\n        }\n\n        var data = Session.get('inviteToApplyData');\n        inviteInProgress.set(true) ;\n        Meteor.call('sendInviteToApplyEmail',[selectedAdvertisements,data.user._id],function(error, result){\n            inviteInProgress.set(false) ;\n            if(error){\n                console.log(error);\n                var tmp =  Session.get(\"showErrorDlg\");if(!tmp)tmp=[];\n                tmp.push(\"Failed applying. Please try again, try checking your internet connectivity. Contact us if needed.\");\n                Session.set(\"showErrorDlg\",tmp)\n                return;\n            }\n            if(result.status=='Success'){\n                console.log(\"Success\");\n                closePopupEvent()\n            }\n        });\n\n    },\n    'click .closePopupBtn':function () {\n        closePopupEvent()\n    }\n})\nfunction titleCase(str){\n    if(!str)return;\n    return str.charAt(0).toUpperCase() + str.toLowerCase().substring(1);\n}\nfunction getPaginationData(totalResultsCount,currentPageNo,urlBase, resultsPerPage){\n    var pages = [], prevPage = {}, nextPage={};\n    var pgMin = currentPageNo-4, pgMax = currentPageNo+ 5, maxPages = Math.ceil(totalResultsCount/resultsPerPage)\n    if(pgMin<1)pgMin =1;\n    if(pgMax<1)pgMax =1;\n    if(maxPages<1)maxPages =1;\n    if(pgMin>maxPages)currentPageNo =maxPages;\n    var tmp={};\n    for (var i=pgMin; i<=maxPages;i++){\n        var href = urlBase+i+\"/\";\n        tmp = {\n            \"href\": href,\n            \"text\": i\n        }\n        if(i== currentPageNo) {\n            tmp['href'] = 'javascript:void(0);';\n            tmp['current'] = true;\n        }\n        pages.push(tmp)\n    }\n    // if(pgMin==maxPages){//Above loop won't work if only 1 page result\n    //     pages.push({\n    //         \"href\": 'javascript:void(0);',\n    //         \"text\": 1\n    //     })\n    // }\n    var prevPageNo = currentPageNo- 1, nextPageNo=currentPageNo+ 1;\n    if(prevPageNo<1){\n        prevPage['href'] = 'javascript:void(0)';\n        prevPage['text'] = 'Previous';\n        prevPage['disabled'] = 'disabled';\n    }else{\n        prevPage['href'] = urlBase+prevPageNo+\"/\";\n        prevPage['text'] = 'Previous';\n    }\n    if(nextPageNo>maxPages)nextPageNo =maxPages;\n    if(nextPageNo == currentPageNo){\n        nextPage['href'] = 'javascript:void(0)';\n        nextPage['text'] = 'Next';\n        nextPage['disabled'] = 'disabled';\n    }else{\n        nextPage['href'] = urlBase+nextPageNo+\"/\";\n        nextPage['text'] = 'Next';\n    }\n    return {\n        \"prevPage\":prevPage,\n        \"pages\":pages,\n        \"nextPage\": nextPage\n    }\n}\nfunction closePopupEvent() {\n    console.log('closePopupEvent');\n    if($)\n        if($.fancybox)\n            $.fancybox.close();\n}"]},"sourceType":"module","hash":"883ab97012ce1e29a89befd015e71918e837f4d8"}
