{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/home/momen/projects/spotmycrib-master/packages/jns:flow-router-ssr/lib/router.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"packages/jns:flow-router-ssr/lib/router.js","filename":"/home/momen/projects/spotmycrib-master/packages/jns:flow-router-ssr/lib/router.js","targets":{},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/home/momen/projects/spotmycrib-master","root":"/home/momen/projects/spotmycrib-master","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":true,"enforceStrictMode":false,"dynamicImport":true}},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":{},"_verified":{},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"version":"7.13.10","helpers":true,"useESModules":false,"corejs":false}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$3","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$4","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-nullish-coalescing-operator","visitor":{"_exploded":{},"_verified":{},"LogicalExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-chaining","visitor":{"_exploded":{},"_verified":{},"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]}},"options":{}},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-optional-catch-binding","visitor":{"_exploded":{},"_verified":{},"CatchClause":{"enter":[null]}},"options":{}},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"StaticBlock":{"enter":[null]},"TSModuleBlock":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectPattern":{"enter":[null]}},"options":{}},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"ObjectMethod":{"enter":[null],"exit":[null]},"ClassMethod":{"enter":[null],"exit":[null]},"ClassPrivateMethod":{"enter":[null],"exit":[null]},"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]}},"options":{}}],"presets":[],"generatorOpts":{"filename":"/home/momen/projects/spotmycrib-master/packages/jns:flow-router-ssr/lib/router.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"packages/jns:flow-router-ssr/lib/router.js"}},"code":"var Qs;\nmodule.link(\"qs\", {\n  \"default\": function (v) {\n    Qs = v;\n  }\n}, 0);\nvar PathToRegexp;\nmodule.link(\"path-to-regexp\", {\n  \"default\": function (v) {\n    PathToRegexp = v;\n  }\n}, 1);\n\nSharedRouter = /*#__PURE__*/function () {\n  function SharedRouter() {\n    this._routes = [];\n    this._routesMap = {}; // holds onRoute callbacks\n\n    this._onRouteCallbacks = [];\n    this.env = {};\n    this.env.trailingSlash = new Meteor.EnvironmentVariable();\n  }\n\n  var _proto = SharedRouter.prototype;\n\n  _proto.route = function () {\n    function route(pathDef, options, group) {\n      if (!/^\\/.*/.test(pathDef)) {\n        var message = \"route's path must start with '/'\";\n        throw new Error(message);\n      }\n\n      options = options || {};\n      var currentRoute = new Route(this, pathDef, options, group);\n\n      currentRoute._init();\n\n      this._routes.push(currentRoute);\n\n      if (options.name) {\n        this._routesMap[options.name] = currentRoute;\n      }\n\n      this._triggerRouteRegister(currentRoute);\n\n      return currentRoute;\n    }\n\n    return route;\n  }() // XXX this function needs to be cleaned up if possible by removing `if (this.isServer)`\n  // and `if (this.isClient)` if possible\n  ;\n\n  _proto.path = function () {\n    function path(pathDef) {\n      var fields = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var queryParams = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n      if (this._routesMap[pathDef]) {\n        pathDef = this._routesMap[pathDef].path;\n      }\n\n      var newPath = ''; // Prefix the path with the router global prefix\n\n      if (this._basePath) {\n        newPath += \"/\" + this._basePath + \"/\";\n      } // Encode query params\n\n\n      queryParams = this._encodeValues(queryParams);\n      var toPath = PathToRegexp.compile(pathDef);\n      newPath += toPath(fields); // If we have one optional parameter in path definition e.g.\n      // /:category?\n      // and the parameter isn't present, path will be an empty string.\n      // We have this check as a value for path is required by e.g. FlowRouter.go()\n\n      if (!newPath) {\n        newPath = '/';\n      } // Replace multiple slashes with single slash\n\n\n      newPath = newPath.replace(/\\/\\/+/g, '/'); // remove trailing slash\n      // but keep the root slash if it's the only one\n\n      newPath = newPath.match(/^\\/{1}$/) ? newPath : newPath.replace(/\\/$/, ''); // explictly asked to add a trailing slash\n\n      if (this.env.trailingSlash.get() && _.last(newPath) !== '/') {\n        newPath += '/';\n      }\n\n      var strQueryParams = Qs.stringify(queryParams || {});\n\n      if (strQueryParams) {\n        newPath += \"?\" + strQueryParams;\n      }\n\n      return newPath;\n    }\n\n    return path;\n  }();\n\n  _proto.go = function () {\n    function go() {// client only\n    }\n\n    return go;\n  }();\n\n  _proto.watchPathChange = function () {\n    function watchPathChange() {// client only\n    }\n\n    return watchPathChange;\n  }();\n\n  _proto.group = function () {\n    function group(options) {\n      return new Group(this, options);\n    }\n\n    return group;\n  }();\n\n  _proto.url = function () {\n    function url() {\n      // We need to remove the leading base path, or \"/\", as it will be inserted\n      // automatically by `Meteor.absoluteUrl` as documented in:\n      // http://docs.meteor.com/#/full/meteor_absoluteurl\n      var completePath = this.path.apply(this, arguments);\n      var basePath = this._basePath || '/';\n      var pathWithoutBase = completePath.replace(RegExp(\"^\" + basePath), '');\n      return Meteor.absoluteUrl(pathWithoutBase);\n    }\n\n    return url;\n  }() // For client:\n  // .current is not reactive on the client\n  // This is by design. use .getParam() instead\n  // If you really need to watch the path change, use .watchPathChange()\n  ;\n\n  _proto.current = function () {\n    function current() {\n      // We can't trust outside, that's why we clone this\n      // Anyway, we can't clone the whole object since it has non-jsonable values\n      // That's why we clone what's really needed.\n      var context = _.clone(this._getCurrentRouteContext());\n\n      context.queryParams = EJSON.clone(context.queryParams);\n      context.params = EJSON.clone(context.params);\n      return context;\n    }\n\n    return current;\n  }();\n\n  _proto.onRouteRegister = function () {\n    function onRouteRegister(cb) {\n      this._onRouteCallbacks.push(cb);\n    }\n\n    return onRouteRegister;\n  }();\n\n  _proto._encodeValues = function () {\n    function _encodeValues(obj) {\n      var newObj = {};\n      Object.keys(obj).forEach(function (key) {\n        var value = obj[key];\n        newObj[key] = typeof value !== 'undefined' ? encodeURIComponent(value) : value;\n      });\n      return newObj;\n    }\n\n    return _encodeValues;\n  }();\n\n  _proto._triggerRouteRegister = function () {\n    function _triggerRouteRegister(currentRoute) {\n      // We should only need to send a safe set of fields on the route\n      // object.\n      // This is not to hide what's inside the route object, but to show\n      // these are the public APIs\n      var routePublicApi = _.pick(currentRoute, 'name', 'pathDef', 'path');\n\n      var omittingOptionFields = ['triggersEnter', 'triggersExit', 'name', 'action'];\n      routePublicApi.options = _.omit(currentRoute.options, omittingOptionFields);\n\n      this._onRouteCallbacks.forEach(function (cb) {\n        cb(routePublicApi);\n      });\n    }\n\n    return _triggerRouteRegister;\n  }();\n\n  _proto._getCurrentRouteContext = function () {\n    function _getCurrentRouteContext() {\n      throw new Error('Not implemented');\n    }\n\n    return _getCurrentRouteContext;\n  }();\n\n  _proto._init = function () {\n    function _init() {\n      throw new Error('Not implemented');\n    }\n\n    return _init;\n  }();\n\n  _proto.withTrailingSlash = function () {\n    function withTrailingSlash(fn) {\n      return this.env.trailingSlash.withValue(true, fn);\n    }\n\n    return withTrailingSlash;\n  }();\n\n  return SharedRouter;\n}();","map":{"version":3,"sources":["packages/jns:flow-router-ssr/lib/router.js"],"names":["Qs","module","link","v","PathToRegexp","SharedRouter","_routes","_routesMap","_onRouteCallbacks","env","trailingSlash","Meteor","EnvironmentVariable","route","pathDef","options","group","test","message","Error","currentRoute","Route","_init","push","name","_triggerRouteRegister","path","fields","queryParams","newPath","_basePath","_encodeValues","toPath","compile","replace","match","get","_","last","strQueryParams","stringify","go","watchPathChange","Group","url","completePath","basePath","pathWithoutBase","RegExp","absoluteUrl","current","context","clone","_getCurrentRouteContext","EJSON","params","onRouteRegister","cb","obj","newObj","Object","keys","forEach","key","value","encodeURIComponent","routePublicApi","pick","omittingOptionFields","omit","withTrailingSlash","fn","withValue"],"mappings":"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","sourcesContent":["import Qs from 'qs';\nimport PathToRegexp from 'path-to-regexp';\n\nSharedRouter = class {\n  constructor() {\n    this._routes = [];\n    this._routesMap = {};\n\n    // holds onRoute callbacks\n    this._onRouteCallbacks = [];\n\n    this.env = {};\n    this.env.trailingSlash = new Meteor.EnvironmentVariable();\n  }\n\n  route(pathDef, options, group) {\n    if (!/^\\/.*/.test(pathDef)) {\n      const message = \"route's path must start with '/'\";\n      throw new Error(message);\n    }\n\n    options = options || {};\n\n    const currentRoute = new Route(this, pathDef, options, group);\n    currentRoute._init();\n\n    this._routes.push(currentRoute);\n\n\n    if (options.name) {\n      this._routesMap[options.name] = currentRoute;\n    }\n\n    this._triggerRouteRegister(currentRoute);\n\n    return currentRoute;\n  }\n\n  // XXX this function needs to be cleaned up if possible by removing `if (this.isServer)`\n  // and `if (this.isClient)` if possible\n  path(pathDef, fields = {}, queryParams = {}) {\n    if (this._routesMap[pathDef]) {\n      pathDef = this._routesMap[pathDef].path;\n    }\n\n    let newPath = '';\n\n    // Prefix the path with the router global prefix\n    if (this._basePath) {\n      newPath += `/${this._basePath}/`;\n    }\n\n    // Encode query params\n    queryParams = this._encodeValues(queryParams);\n\n    const toPath = PathToRegexp.compile(pathDef);\n    newPath += toPath(fields);\n\n    // If we have one optional parameter in path definition e.g.\n    // /:category?\n    // and the parameter isn't present, path will be an empty string.\n    // We have this check as a value for path is required by e.g. FlowRouter.go()\n    if (!newPath) {\n      newPath = '/';\n    }\n\n    // Replace multiple slashes with single slash\n    newPath = newPath.replace(/\\/\\/+/g, '/');\n\n    // remove trailing slash\n    // but keep the root slash if it's the only one\n    newPath = newPath.match(/^\\/{1}$/) ? newPath : newPath.replace(/\\/$/, '');\n\n    // explictly asked to add a trailing slash\n    if (this.env.trailingSlash.get() && _.last(newPath) !== '/') {\n      newPath += '/';\n    }\n\n    const strQueryParams = Qs.stringify(queryParams || {});\n\n    if (strQueryParams) {\n      newPath += `?${strQueryParams}`;\n    }\n\n    return newPath;\n  }\n\n  go() {\n    // client only\n  }\n\n  watchPathChange() {\n    // client only\n  }\n\n  group(options) {\n    return new Group(this, options);\n  }\n\n  url(...args) {\n    // We need to remove the leading base path, or \"/\", as it will be inserted\n    // automatically by `Meteor.absoluteUrl` as documented in:\n    // http://docs.meteor.com/#/full/meteor_absoluteurl\n    const completePath = this.path(...args);\n    const basePath = this._basePath || '/';\n    const pathWithoutBase = completePath.replace(RegExp(`^${basePath}`), '');\n    return Meteor.absoluteUrl(pathWithoutBase);\n  }\n\n  // For client:\n  // .current is not reactive on the client\n  // This is by design. use .getParam() instead\n  // If you really need to watch the path change, use .watchPathChange()\n  current() {\n    // We can't trust outside, that's why we clone this\n    // Anyway, we can't clone the whole object since it has non-jsonable values\n    // That's why we clone what's really needed.\n    const context = _.clone(this._getCurrentRouteContext());\n\n    context.queryParams = EJSON.clone(context.queryParams);\n    context.params = EJSON.clone(context.params);\n\n    return context;\n  }\n\n  onRouteRegister(cb) {\n    this._onRouteCallbacks.push(cb);\n  }\n\n  _encodeValues(obj) {\n    const newObj = {};\n    Object.keys(obj).forEach(key => {\n      const value = obj[key];\n      newObj[key] = typeof value !== 'undefined' ? encodeURIComponent(value) : value;\n    });\n\n    return newObj;\n  }\n\n  _triggerRouteRegister(currentRoute) {\n    // We should only need to send a safe set of fields on the route\n    // object.\n    // This is not to hide what's inside the route object, but to show\n    // these are the public APIs\n    const routePublicApi = _.pick(currentRoute, 'name', 'pathDef', 'path');\n    const omittingOptionFields = [\n      'triggersEnter', 'triggersExit', 'name', 'action'\n    ];\n    routePublicApi.options = _.omit(currentRoute.options, omittingOptionFields);\n\n    this._onRouteCallbacks.forEach((cb) => {\n      cb(routePublicApi);\n    });\n  }\n\n  _getCurrentRouteContext() {\n    throw new Error('Not implemented');\n  }\n\n  _init() {\n    throw new Error('Not implemented');\n  }\n\n  withTrailingSlash(fn) {\n    return this.env.trailingSlash.withValue(true, fn);\n  }\n};\n"]},"sourceType":"module","hash":"8d96710ea8ac3a50c2ab0970b00b9d7791844a82"}
