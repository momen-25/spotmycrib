[{"type":"js","data":"(function () {\n\n/* Imports */\nvar Meteor = Package.meteor.Meteor;\nvar global = Package.meteor.global;\nvar meteorEnv = Package.meteor.meteorEnv;\nvar WebApp = Package.webapp.WebApp;\nvar WebAppInternals = Package.webapp.WebAppInternals;\nvar main = Package.webapp.main;\n\n/* Package-scope variables */\nvar robots;\n\n(function(){\n\n//////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                              //\n// packages/gadicohen_robots-txt/packages/gadicohen_robots-txt.js                               //\n//                                                                                              //\n//////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                //\n(function () {\n\n////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                        //\n// packages/gadicohen:robots-txt/robots.js                                                //\n//                                                                                        //\n////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                          //\nvar pubRoot, match, stack;                                                                // 1\nvar fs = Npm.require('fs'),                                                               // 2\n  path = Npm.require('path');                                                             // 3\n                                                                                          // 4\nif (__meteor_bootstrap__.bundle) {                                                        // 5\n\t// TODO, remove in 2014                                                                  // 6\n\tpubRoot = __meteor_bootstrap__.bundle.root + 'public';                                   // 7\n} else {                                                                                  // 8\n\tpubRoot = path.join(__meteor_bootstrap__.serverDir, '..', 'client', 'app');              // 9\n//\tWebApp.clientProgram.manifest = _.reject(WebApp.clientProgram.manifest, function(cp) { // 10\n//\t\treturn cp.url == '/robots.txt';                                                       // 11\n//\t});                                                                                    // 12\n//\tRoutePolicy.declare('/robots.txt', 'network');                                         // 13\n}                                                                                         // 14\n                                                                                          // 15\n// TODO, remove in 2014                                                                   // 16\nstack = __meteor_bootstrap__.app                                                          // 17\n\t? __meteor_bootstrap__.app.stack                                                         // 18\n    : WebApp.connectHandlers.stack;                                                       // 19\n                                                                                          // 20\n// splice necessary to jump ahead of original /robots.txt route                           // 21\nstack.splice(0, 0, {                                                                      // 22\n\troute: '/robots.txt',                                                                    // 23\n\thandle: function(req, res, next) {                                                       // 24\n\t\tfs.readFile(pubRoot + '/robots.txt', function(err, data) {                              // 25\n\t\t\trobotsOut(res, err, data);                                                             // 26\n\t\t}.future());                                                                            // 27\n\t}                                                                                        // 28\n});                                                                                       // 29\n                                                                                          // 30\n                                                                                          // 31\n/*                                                                                        // 32\nvar app = typeof WebApp != 'undefined'                                                    // 33\n    ? WebApp.connectHandlers : __meteor_bootstrap__.app;                                  // 34\napp.use(function(req, res, next) {                                                        // 35\n\tLog(3);                                                                                  // 36\n\tconsole.log(req.url);                                                                    // 37\n\treturn next();                                                                           // 38\n});                                                                                       // 39\n*/                                                                                        // 40\n                                                                                          // 41\nrobots = {                                                                                // 42\n\tlines: []                                                                                // 43\n};                                                                                        // 44\n                                                                                          // 45\nfunction robotsOut(res, err, data) {                                                      // 46\n\tres.writeHead(200, {'Content-Type': 'text/plain'});                                      // 47\n                                                                                          // 48\n\t// Generally: if the file exists, serve it.                                              // 49\n\tif (!err)                                                                                // 50\n\t\tres.write(data + '\\n');                                                                 // 51\n                                                                                          // 52\n\t// Iterate through all our other added lines                                             // 53\n\tfor (var i=0; i < robots.lines.length; i++)                                              // 54\n\t\tres.write(robots.lines[i] + '\\n');                                                      // 55\n                                                                                          // 56\n\tres.end();                                                                               // 57\n}                                                                                         // 58\n                                                                                          // 59\nrobots.addLine = function(line) {                                                         // 60\n\tthis.lines.push(line);                                                                   // 61\n};                                                                                        // 62\n                                                                                          // 63\n////////////////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n\n//////////////////////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n\n\n/* Exports */\nPackage._define(\"gadicohen:robots-txt\", {\n  robots: robots\n});\n\n})();\n","servePath":"/packages/gadicohen_robots-txt.js"}]